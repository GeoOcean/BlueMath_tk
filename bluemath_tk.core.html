

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bluemath_tk.core package &mdash; Bluemath-Toolkit  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bluemath_tk.core.data package" href="bluemath_tk.core.data.html" />
    <link rel="prev" title="bluemath_tk.config package" href="bluemath_tk.config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Bluemath-Toolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contributions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bluemath_tk</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bluemath_tk.html">bluemath_tk package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bluemath_tk.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.additive.html">bluemath_tk.additive package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.config.html">bluemath_tk.config package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">bluemath_tk.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.datamining.html">bluemath_tk.datamining package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.deeplearning.html">bluemath_tk.deeplearning package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.distributions.html">bluemath_tk.distributions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.downloaders.html">bluemath_tk.downloaders package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.interpolation.html">bluemath_tk.interpolation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.predictor.html">bluemath_tk.predictor package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.risk.html">bluemath_tk.risk package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.tcs.html">bluemath_tk.tcs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.teslakit.html">bluemath_tk.teslakit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.tide.html">bluemath_tk.tide package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.topo_bathy.html">bluemath_tk.topo_bathy package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.waves.html">bluemath_tk.waves package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.wrappers.html">bluemath_tk.wrappers package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.html#module-bluemath_tk">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bluemath-Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">bluemath_tk</a></li>
          <li class="breadcrumb-item"><a href="bluemath_tk.html">bluemath_tk package</a></li>
      <li class="breadcrumb-item active">bluemath_tk.core package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bluemath_tk.core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bluemath-tk-core-package">
<h1>bluemath_tk.core package<a class="headerlink" href="#bluemath-tk-core-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="bluemath_tk.core.data.html">bluemath_tk.core.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.data.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.data.html#module-bluemath_tk.core.data.sample_data">bluemath_tk.core.data.sample_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.data.html#bluemath_tk.core.data.sample_data.get_2d_dataset"><code class="docutils literal notranslate"><span class="pre">get_2d_dataset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.data.html#module-bluemath_tk.core.data">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bluemath_tk.core.plotting.html">bluemath_tk.core.plotting package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting.base_plotting">bluemath_tk.core.plotting.base_plotting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.BasePlotting"><code class="docutils literal notranslate"><span class="pre">BasePlotting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.BasePlotting.plot_line"><code class="docutils literal notranslate"><span class="pre">BasePlotting.plot_line()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.BasePlotting.plot_scatter"><code class="docutils literal notranslate"><span class="pre">BasePlotting.plot_scatter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultInteractivePlotting"><code class="docutils literal notranslate"><span class="pre">DefaultInteractivePlotting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultInteractivePlotting.plot_line"><code class="docutils literal notranslate"><span class="pre">DefaultInteractivePlotting.plot_line()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultInteractivePlotting.plot_map"><code class="docutils literal notranslate"><span class="pre">DefaultInteractivePlotting.plot_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultInteractivePlotting.plot_scatter"><code class="docutils literal notranslate"><span class="pre">DefaultInteractivePlotting.plot_scatter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.get_subplot"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.get_subplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.get_subplots"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.get_subplots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.plot_bathymetry"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.plot_bathymetry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.plot_line"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.plot_line()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.plot_satellite"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.plot_satellite()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.plot_scatter"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.plot_scatter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.base_plotting.DefaultStaticPlotting.templates"><code class="docutils literal notranslate"><span class="pre">DefaultStaticPlotting.templates</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting.colors">bluemath_tk.core.plotting.colors module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.GetFamsColors"><code class="docutils literal notranslate"><span class="pre">GetFamsColors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colormap_bathy"><code class="docutils literal notranslate"><span class="pre">colormap_bathy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colormap_spectra"><code class="docutils literal notranslate"><span class="pre">colormap_spectra()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colors_awt"><code class="docutils literal notranslate"><span class="pre">colors_awt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colors_dwt"><code class="docutils literal notranslate"><span class="pre">colors_dwt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colors_fams_3"><code class="docutils literal notranslate"><span class="pre">colors_fams_3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colors_interp"><code class="docutils literal notranslate"><span class="pre">colors_interp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.colors_mjo"><code class="docutils literal notranslate"><span class="pre">colors_mjo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.get_cluster_colors"><code class="docutils literal notranslate"><span class="pre">get_cluster_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.colors.get_config_variables"><code class="docutils literal notranslate"><span class="pre">get_config_variables()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting.satellite">bluemath_tk.core.plotting.satellite module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.calculate_zoom"><code class="docutils literal notranslate"><span class="pre">calculate_zoom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.deg2num"><code class="docutils literal notranslate"><span class="pre">deg2num()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.get_cartopy_scale"><code class="docutils literal notranslate"><span class="pre">get_cartopy_scale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.get_satellite_image"><code class="docutils literal notranslate"><span class="pre">get_satellite_image()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.lonlat_to_webmercator"><code class="docutils literal notranslate"><span class="pre">lonlat_to_webmercator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.num2deg"><code class="docutils literal notranslate"><span class="pre">num2deg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.satellite.tile_bounds_meters"><code class="docutils literal notranslate"><span class="pre">tile_bounds_meters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting.scatter">bluemath_tk.core.plotting.scatter module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.scatter.density_scatter"><code class="docutils literal notranslate"><span class="pre">density_scatter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.scatter.plot_scatters_in_triangle"><code class="docutils literal notranslate"><span class="pre">plot_scatters_in_triangle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.scatter.validation_scatter"><code class="docutils literal notranslate"><span class="pre">validation_scatter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting.utils">bluemath_tk.core.plotting.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.utils.create_cmap_from_colors"><code class="docutils literal notranslate"><span class="pre">create_cmap_from_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.utils.get_list_of_colors_for_colormap"><code class="docutils literal notranslate"><span class="pre">get_list_of_colors_for_colormap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.core.plotting.html#bluemath_tk.core.plotting.utils.join_colormaps"><code class="docutils literal notranslate"><span class="pre">join_colormaps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bluemath_tk.core.plotting.html#module-bluemath_tk.core.plotting">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-bluemath_tk.core.constants">
<span id="bluemath-tk-core-constants-module"></span><h2>bluemath_tk.core.constants module<a class="headerlink" href="#module-bluemath_tk.core.constants" title="Link to this heading"></a></h2>
</section>
<section id="module-bluemath_tk.core.dask">
<span id="bluemath-tk-core-dask-module"></span><h2>bluemath_tk.core.dask module<a class="headerlink" href="#module-bluemath_tk.core.dask" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.dask.get_available_ram">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.dask.</span></span><span class="sig-name descname"><span class="pre">get_available_ram</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/dask.html#get_available_ram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.dask.get_available_ram" title="Link to this definition"></a></dt>
<dd><p>Get the available RAM in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The available RAM in bytes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.dask.get_total_ram">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.dask.</span></span><span class="sig-name descname"><span class="pre">get_total_ram</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/dask.html#get_total_ram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.dask.get_total_ram" title="Link to this definition"></a></dt>
<dd><p>Get the total RAM in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The total RAM in bytes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.dask.setup_dask_client">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.dask.</span></span><span class="sig-name descname"><span class="pre">setup_dask_client</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/dask.html#setup_dask_client"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.dask.setup_dask_client" title="Link to this definition"></a></dt>
<dd><p>Setup a Dask client with controlled resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of workers. Default is None.</p></li>
<li><p><strong>memory_limit</strong> (<em>str</em><em>, </em><em>optional</em>) – Memory limit per worker. Default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dask distributed client</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Client</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Resources might vary depending on the hardware and the load of the machine.
Be very careful when setting the number of workers and memory limit, as it
might affect the performance of the machine, or in the worse case scenario,
the performance of other users in the same machine (cluster case).</p></li>
</ul>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.decorators">
<span id="bluemath-tk-core-decorators-module"></span><h2>bluemath_tk.core.decorators module<a class="headerlink" href="#module-bluemath_tk.core.decorators" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_calval">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_calval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_calval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_calval" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in CalVal class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_kma">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_kma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_kma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_kma" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in KMA class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_lhs">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_lhs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_lhs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_lhs" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in LHS class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_mda">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_mda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_mda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_mda" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in MDA class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_pca">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_pca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_pca" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in PCA class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_rbf">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_rbf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_rbf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_rbf" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in RBF class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_som">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_som</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_som"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_som" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in SOM class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.decorators.validate_data_xwt">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.decorators.</span></span><span class="sig-name descname"><span class="pre">validate_data_xwt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/core/decorators.html#validate_data_xwt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.decorators.validate_data_xwt" title="Link to this definition"></a></dt>
<dd><p>Decorator to validate data in XWT class fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be decorated</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.geo">
<span id="bluemath-tk-core-geo-module"></span><h2>bluemath_tk.core.geo module<a class="headerlink" href="#module-bluemath_tk.core.geo" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.buffer_area_for_polygon">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">buffer_area_for_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#buffer_area_for_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.buffer_area_for_polygon" title="Link to this definition"></a></dt>
<dd><p>Buffer the polygon by a factor of its area divided by its length.
This is a heuristic to ensure that the buffer is proportional to the size of the polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygon</strong> (<em>Polygon</em>) – The polygon to be buffered.</p></li>
<li><p><strong>mas</strong> (<em>float</em>) – The buffer factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The buffered polygon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polygon</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mas</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buffered_polygon</span> <span class="o">=</span> <span class="n">buffer_area_for_polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">mas</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">buffered_polygon</span><span class="p">)</span>
<span class="go">POLYGON ((-0.1 -0.1, 1.1 -0.1, 1.1 1.1, -0.1 1.1, -0.1 -0.1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.convert_to_radians">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">convert_to_radians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#convert_to_radians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.convert_to_radians" title="Link to this definition"></a></dt>
<dd><p>Convert degree inputs to radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Variable number of inputs in degrees to convert to radians.
Can be either scalar floats or numpy arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of input values converted to radians, preserving input types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_radians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)</span>
<span class="go">(1.5707963267948966,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convert_to_radians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">)</span>
<span class="go">(1.5707963267948966, 3.141592653589793)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.create_polygon">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">create_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Polygon</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#create_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.create_polygon" title="Link to this definition"></a></dt>
<dd><p>Create a polygon from a list of (longitude, latitude) coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coordinates</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – List of (longitude, latitude) coordinate pairs that define the polygon vertices.
The first and last points should be the same to close the polygon.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A shapely Polygon object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polygon</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">create_polygon</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.filter_points_in_polygon">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">filter_points_in_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#filter_points_in_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.filter_points_in_polygon" title="Link to this definition"></a></dt>
<dd><p>Filter points to keep only those inside a polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – Array or list of longitude values.</p></li>
<li><p><strong>lat</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – Array or list of latitude values.
Must have the same shape as lon.</p></li>
<li><p><strong>polygon</strong> (<em>Polygon</em>) – A shapely Polygon object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing:
- filtered_lon : Array of longitudes inside the polygon
- filtered_lat : Array of latitudes inside the polygon</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If lon and lat arrays have different shapes.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">create_polygon</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_lon</span><span class="p">,</span> <span class="n">filtered_lat</span> <span class="o">=</span> <span class="n">filter_points_in_polygon</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_lon</span><span class="p">)</span>  <span class="c1"># [0.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">filtered_lat</span><span class="p">)</span>  <span class="c1"># [0.5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.geo_distance_cartesian">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">geo_distance_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#geo_distance_cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.geo_distance_cartesian" title="Link to this definition"></a></dt>
<dd><p>Returns cartesian distance between y,x matrix and y,x point.
Optimized using vectorized operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_matrix</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – 2D array of y-coordinates (latitude or y in Cartesian).</p></li>
<li><p><strong>x_matrix</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – 2D array of x-coordinates (longitude or x in Cartesian).</p></li>
<li><p><strong>y_point</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – y-coordinate of the point (latitude or y in Cartesian).</p></li>
<li><p><strong>x_point</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – x-coordinate of the point (longitude or x in Cartesian).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of distances in the same units as x_matrix and y_matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.geodesic_azimuth">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">geodesic_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#geodesic_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.geodesic_azimuth" title="Link to this definition"></a></dt>
<dd><p>Calculate azimuth between two points on Earth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of first point(s) in degrees</p></li>
<li><p><strong>lon1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of first point(s) in degrees</p></li>
<li><p><strong>lat2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of second point(s) in degrees</p></li>
<li><p><strong>lon2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of second point(s) in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Azimuth(s) in degrees from North</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The azimuth is the angle between true north and the direction to the second point,
measured clockwise from north. Special cases are handled for points at the poles.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geodesic_azimuth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="go">90.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geodesic_azimuth</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="go">array([90., 90.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.geodesic_distance">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">geodesic_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#geodesic_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.geodesic_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate great circle distance between two points on Earth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of first point(s) in degrees</p></li>
<li><p><strong>lon1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of first point(s) in degrees</p></li>
<li><p><strong>lat2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of second point(s) in degrees</p></li>
<li><p><strong>lon2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of second point(s) in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Great circle distance(s) in degrees</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[float, np.ndarray]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses the haversine formula to calculate great circle distance.
The result is in degrees of arc on a sphere.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geodesic_distance</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="go">90.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geodesic_distance</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="go">array([90., 180.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.geodesic_distance_azimuth">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">geodesic_distance_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#geodesic_distance_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.geodesic_distance_azimuth" title="Link to this definition"></a></dt>
<dd><p>Calculate both great circle distance and azimuth between two points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of first point(s) in degrees</p></li>
<li><p><strong>lon1</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of first point(s) in degrees</p></li>
<li><p><strong>lat2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Latitude of second point(s) in degrees</p></li>
<li><p><strong>lon2</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Longitude of second point(s) in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing:
- distance(s) : Great circle distance(s) in degrees
- azimuth(s) : Azimuth(s) in degrees from North</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Union[float, np.ndarray], Union[float, np.ndarray]]</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bluemath_tk.core.geo.geodesic_distance" title="bluemath_tk.core.geo.geodesic_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geodesic_distance</span></code></a></dt><dd><p>Calculate only the great circle distance</p>
</dd>
<dt><a class="reference internal" href="#bluemath_tk.core.geo.geodesic_azimuth" title="bluemath_tk.core.geo.geodesic_azimuth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geodesic_azimuth</span></code></a></dt><dd><p>Calculate only the azimuth</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">,</span> <span class="n">az</span> <span class="o">=</span> <span class="n">geodesic_distance_azimuth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span>
<span class="go">90.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">az</span>
<span class="go">90.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.mask_points_outside_polygon">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">mask_points_outside_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#mask_points_outside_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.mask_points_outside_polygon" title="Link to this definition"></a></dt>
<dd><p>Returns a boolean mask indicating which triangle elements have at least two vertices outside the polygon.</p>
<p>This version uses matplotlib.path.Path for high-performance point-in-polygon testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>(</em><em>n_elements</em><em>, </em><em>3</em><em>) </em><em>np.ndarray</em>) – Array containing indices of triangle vertices.</p></li>
<li><p><strong>node_coords</strong> (<em>(</em><em>n_nodes</em><em>, </em><em>2</em><em>) </em><em>np.ndarray</em>) – Array of node coordinates as (x, y) pairs.</p></li>
<li><p><strong>poly</strong> (<em>shapely.geometry.Polygon</em>) – Polygon used for containment checks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mask</strong> – Boolean array where True means at least two vertices of the triangle lie outside the polygon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n_elements,) np.ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">node_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask_points_outside_polygon</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">node_coords</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="go">[False False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.points_in_polygon">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">points_in_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#points_in_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.points_in_polygon" title="Link to this definition"></a></dt>
<dd><p>Check which points are inside a polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – Array or list of longitude values.</p></li>
<li><p><strong>lat</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>np.ndarray</em><em>]</em>) – Array or list of latitude values.
Must have the same shape as lon.</p></li>
<li><p><strong>polygon</strong> (<em>Polygon</em>) – A shapely Polygon object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean array indicating which points are inside the polygon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If lon and lat arrays have different shapes.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Square</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">poly</span> <span class="o">=</span> <span class="n">create_polygon</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">points_in_polygon</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>  <span class="c1"># [True, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.geo.shoot">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.geo.</span></span><span class="sig-name descname"><span class="pre">shoot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/geo.html#shoot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.geo.shoot" title="Link to this definition"></a></dt>
<dd><p>Calculate endpoint given starting point, azimuth and distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Starting longitude(s) in degrees</p></li>
<li><p><strong>lat</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Starting latitude(s) in degrees</p></li>
<li><p><strong>azimuth</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Initial azimuth(s) in degrees</p></li>
<li><p><strong>maxdist</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>np.ndarray</em><em>]</em>) – Distance(s) to travel in kilometers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing:
- final_lon : Final longitude(s) in degrees
- final_lat : Final latitude(s) in degrees
- back_azimuth : Back azimuth(s) in degrees</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Union[float, np.ndarray], Union[float, np.ndarray], Union[float, np.ndarray]]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function implements a geodesic shooting algorithm based on
T. Vincenty’s method. It accounts for the Earth’s ellipsoidal shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If attempting to shoot from a pole in a direction not along a meridian.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon_f</span><span class="p">,</span> <span class="n">lat_f</span><span class="p">,</span> <span class="n">baz</span> <span class="o">=</span> <span class="n">shoot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">111.195</span><span class="p">)</span>  <span class="c1"># ~1 degree at equator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">lon_f</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">lat_f</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">baz</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">270.0</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.io">
<span id="bluemath-tk-core-io-module"></span><h2>bluemath_tk.core.io module<a class="headerlink" href="#module-bluemath_tk.core.io" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.io.load_model">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.io.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel" title="bluemath_tk.core.models.BlueMathModel"><span class="pre">BlueMathModel</span></a></span></span><a class="reference internal" href="_modules/bluemath_tk/core/io.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.io.load_model" title="Link to this definition"></a></dt>
<dd><p>Loads a BlueMathModel from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>str</em>) – The path to the model file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded BlueMathModel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel" title="bluemath_tk.core.models.BlueMathModel">BlueMathModel</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.logging">
<span id="bluemath-tk-core-logging-module"></span><h2>bluemath_tk.core.logging module<a class="headerlink" href="#module-bluemath_tk.core.logging" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.logging.get_file_logger">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.logging.</span></span><span class="sig-name descname"><span class="pre">get_file_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'INFO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">console</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">console_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'WARNING'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Logger</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/logging.html#get_file_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.logging.get_file_logger" title="Link to this definition"></a></dt>
<dd><p>Creates and returns a logger that writes log messages to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the logger.</p></li>
<li><p><strong>logs_path</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path where the log messages will be written. Default is None.</p></li>
<li><p><strong>level</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The logging level. Default is “INFO”.</p></li>
<li><p><strong>console</strong> (<em>bool</em>) – Whether to add or not console / terminal logs. Default is True.</p></li>
<li><p><strong>console_level</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The logging level for console / terminal logs. Default is “WARNING”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_file_logger</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a logger that writes to &quot;app.log&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_file_logger</span><span class="p">(</span><span class="s2">&quot;my_app_logger&quot;</span><span class="p">,</span> <span class="s2">&quot;app.log&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Log messages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;This is an info message.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This is a warning message.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;This is an error message.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The output will be saved in &quot;app.log&quot; with the format:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2023-10-22 14:55:23,456 - my_app_logger - INFO - This is an info message.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2023-10-22 14:55:23,457 - my_app_logger - WARNING - This is a warning message.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2023-10-22 14:55:23,458 - my_app_logger - ERROR - This is an error message.</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.metrics">
<span id="bluemath-tk-core-metrics-module"></span><h2>bluemath_tk.core.metrics module<a class="headerlink" href="#module-bluemath_tk.core.metrics" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.bias">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.bias" title="Link to this definition"></a></dt>
<dd><p>Calculate the BIAS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The BIAS value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.mae">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">mae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#mae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.mae" title="Link to this definition"></a></dt>
<dd><p>Calculate Mean Absolute Error (MAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean absolute error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.mse">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.mse" title="Link to this definition"></a></dt>
<dd><p>Calculate Mean Squared Error (MSE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean squared error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.r2">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.r2" title="Link to this definition"></a></dt>
<dd><p>Calculate the R² score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The R² score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.rmse">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.rmse" title="Link to this definition"></a></dt>
<dd><p>Calculate Root Mean Squared Error (RMSE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Root mean squared error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.metrics.si">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.metrics.</span></span><span class="sig-name descname"><span class="pre">si</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/metrics.html#si"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.metrics.si" title="Link to this definition"></a></dt>
<dd><p>Calculate the Scatter Index (SI).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_true</strong> (<em>np.ndarray</em>) – True values.</p></li>
<li><p><strong>X_pred</strong> (<em>np.ndarray</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Scatter Index value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bluemath_tk.core.models">
<span id="bluemath-tk-core-models-module"></span><h2>bluemath_tk.core.models module<a class="headerlink" href="#module-bluemath_tk.core.models" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.models.</span></span><span class="sig-name descname"><span class="pre">BlueMathModel</span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for handling default functionalities across the project.</p>
<p>This class provides core functionality used by all BlueMath models including:
- Model saving and loading
- Data normalization and denormalization
- Parallel processing capabilities
- Logging functionality
- NaN handling
- Directional data processing</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.gravity">
<span class="sig-name descname"><span class="pre">gravity</span></span><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.gravity" title="Link to this definition"></a></dt>
<dd><p>Gravitational constant from scipy.constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.earth_radius">
<span class="sig-name descname"><span class="pre">earth_radius</span></span><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.earth_radius" title="Link to this definition"></a></dt>
<dd><p>Earth radius in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.num_workers" title="Link to this definition"></a></dt>
<dd><p>Number of parallel workers to use for processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.logger" title="Link to this definition"></a></dt>
<dd><p>Logger instance for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>All BlueMath models should inherit from this class to ensure consistent
behavior and functionality across the project.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.check_nans">
<span class="sig-name descname"><span class="pre">check_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.check_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.check_nans" title="Link to this definition"></a></dt>
<dd><p>Check for NaNs in the data and optionally replace them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>, </em><em>xr.DataArray</em><em>, </em><em>xr.Dataset</em><em>]</em>) – The data to check for NaNs.</p></li>
<li><p><strong>replace_value</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>callable</em><em>]</em><em>, </em><em>optional</em>) – Value to replace NaNs with. If callable, the function will be called
on the data. Default is None (no replacement).</p></li>
<li><p><strong>raise_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to raise an error if NaNs are found. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – The data with NaNs optionally replaced.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[np.ndarray, pd.Series, pd.DataFrame, xr.DataArray, xr.Dataset]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If NaNs are found and raise_error is True.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For numpy arrays, uses np.isnan() to check for NaNs</p></li>
<li><p>For pandas objects, uses isnull() to check for NaNs</p></li>
<li><p>For xarray objects, uses isnull() to check for NaNs</p></li>
<li><p>If replace_value is callable, it takes precedence over other options</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">check_nans</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">replace_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">)</span>
<span class="go">   a</span>
<span class="go">0  1</span>
<span class="go">1  0</span>
<span class="go">2  3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.denormalize">
<span class="sig-name descname"><span class="pre">denormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.denormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.denormalize" title="Link to this definition"></a></dt>
<dd><p>Denormalize data using provided scale_factor.
More info in bluemath_tk.core.operations.denormalize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame</em>) – The normalized data to denormalize.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – The scale factors used for denormalization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – The denormalized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.destandarize">
<span class="sig-name descname"><span class="pre">destandarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">standarized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.destandarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.destandarize" title="Link to this definition"></a></dt>
<dd><p>Destandarize data using provided scaler.
More info in bluemath_tk.core.operations.destandarize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Standarized data to be destandarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Destandarized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, pd.DataFrame or xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">earth_radius</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6378.135</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.get_degrees_from_uv">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_degrees_from_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_degrees_from_uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.get_degrees_from_uv" title="Link to this definition"></a></dt>
<dd><p>This method calculates the degrees from the u and v components.</p>
<dl>
<dt>Here, we assume u and v represent angles between 0 and 360 degrees,</dt><dd><p>where 0° is the North direction,
and increasing clockwise.</p>
<blockquote>
<div><dl>
<dt>(u=0, v=1)</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>(u=-1, v=0) &lt;———&gt; (u=1, v=0)</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div></blockquote>
<p>(u=0, v=-1)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xu</strong> (<em>np.ndarray</em>) – The u component.</p></li>
<li><p><strong>xv</strong> (<em>np.ndarray</em>) – The v component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.get_metrics">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.get_metrics" title="Link to this definition"></a></dt>
<dd><p>Gets the metrics of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The first dataset.</p></li>
<li><p><strong>data2</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The second dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – The metrics of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the DataFrames or Datasets have different shapes.</p></li>
<li><p><strong>TypeError</strong> – If the inputs are not both DataFrames or both xarray Datasets.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.get_num_processors_available">
<span class="sig-name descname"><span class="pre">get_num_processors_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_num_processors_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.get_num_processors_available" title="Link to this definition"></a></dt>
<dd><p>Gets the number of processors available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of processors available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.get_uv_components">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_uv_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_uv_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.get_uv_components" title="Link to this definition"></a></dt>
<dd><p>This method calculates the u and v components for the given directional data.</p>
<dl>
<dt>Here, we assume that the directional data is in degrees,</dt><dd><p>beign 0° the North direction,
and increasing clockwise.</p>
<blockquote>
<div><dl>
<dt>0° N</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>270° W &lt;———&gt; 90° E</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div></blockquote>
<p>90° S</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_deg</strong> (<em>np.ndarray</em>) – The directional data in degrees.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The u and v components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">gravity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9.80665</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.list_class_attributes">
<span class="sig-name descname"><span class="pre">list_class_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.list_class_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.list_class_attributes" title="Link to this definition"></a></dt>
<dd><p>List all non-callable attributes of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Names of all non-callable, non-private attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Excludes methods and private attributes (starting with __)</p></li>
<li><p>Includes properties and class variables</p></li>
<li><p>Useful for introspection and debugging</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">list_class_attributes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
<span class="go">[&#39;gravity&#39;, &#39;num_workers&#39;, &#39;_logger&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.list_class_methods">
<span class="sig-name descname"><span class="pre">list_class_methods</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.list_class_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.list_class_methods" title="Link to this definition"></a></dt>
<dd><p>List all callable methods of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Names of all callable, non-private methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Excludes attributes and private methods (starting with __)</p></li>
<li><p>Includes instance methods and properties</p></li>
<li><p>Useful for introspection and debugging</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methods</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">list_class_methods</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>
<span class="go">[&#39;normalize&#39;, &#39;denormalize&#39;, &#39;check_nans&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel" title="bluemath_tk.core.models.BlueMathModel"><span class="pre">BlueMathModel</span></a></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.load_model" title="Link to this definition"></a></dt>
<dd><p>Loads the model from a file.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Get the logger instance for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The logger instance. Creates a new file logger if none exists.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>logging.Logger</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Lazily instantiates logger on first access</p></li>
<li><p>Uses class name as default logger name</p></li>
<li><p>Thread-safe logger creation</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize data to 0-1 using min max scaler approach.
More info in bluemath_tk.core.operations.normalize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The data to normalize.</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – Custom scale factors for normalization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame or xr.Dataset</em>) – The normalized data.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – The scale factors used for normalization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.parallel_execute">
<span class="sig-name descname"><span class="pre">parallel_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu_intensive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.parallel_execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.parallel_execute" title="Link to this definition"></a></dt>
<dd><p>Execute a function in parallel across multiple items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>) – The function to execute. Should accept single item and <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs.</p></li>
<li><p><strong>items</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – List of items to process in parallel.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of parallel workers to use.</p></li>
<li><p><strong>cpu_intensive</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses ProcessPoolExecutor, otherwise ThreadPoolExecutor.
Default is False.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to func.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping item indices to function results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[int, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – Any exception raised by func is logged and the job continues.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses ThreadPoolExecutor for I/O-bound tasks</p></li>
<li><p>Uses ProcessPoolExecutor for CPU-bound tasks</p></li>
<li><p>Results maintain original item order via index mapping</p></li>
<li><p>Failed jobs are logged but don’t stop execution</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>ThreadPoolExecutor may have GIL limitations</p></li>
<li><p>ProcessPoolExecutor doesn’t work with non-picklable objects</p></li>
<li><p>File operations may fail with ThreadPoolExecutor</p></li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parallel_execute</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">{0: 1, 1: 4, 2: 9}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_attributes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.save_model" title="Link to this definition"></a></dt>
<dd><p>Save the model to a file using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path where the model will be saved.</p></li>
<li><p><strong>exclude_attributes</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of attribute names to exclude from saving. Default is None.
If provided, it will override the default _exclude_attributes.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses pickle for serialization</p></li>
<li><p>Warns if any xarray Datasets/DataArrays are being pickled</p></li>
<li><p>Creates parent directories if they don’t exist</p></li>
<li><p>Excludes specified attributes from serialization</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Pickle files can be security risks if loaded from untrusted sources</p></li>
<li><p>xarray objects in the model will be pickled and may be large</p></li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyBlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model.pkl&#39;</span><span class="p">,</span> <span class="n">exclude_attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_logger&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.set_logger_name">
<span class="sig-name descname"><span class="pre">set_logger_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'INFO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">console</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_logger_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.set_logger_name" title="Link to this definition"></a></dt>
<dd><p>Configure the model’s logger with a new name and settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name to give to the logger.</p></li>
<li><p><strong>level</strong> (<em>str</em><em>, </em><em>optional</em>) – The logging level to use. Default is “INFO”.
Valid values are: “DEBUG”, “INFO”, “WARNING”, “ERROR”, “CRITICAL”</p></li>
<li><p><strong>console</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to output logs to console. Default is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Creates a new file logger with specified settings</p></li>
<li><p>Previous logger settings are overwritten</p></li>
<li><p>Log files are created in the default logging directory</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_logger_name</span><span class="p">(</span><span class="s2">&quot;my_model&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="n">console</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.set_num_processors_to_use">
<span class="sig-name descname"><span class="pre">set_num_processors_to_use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_processors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_num_processors_to_use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.set_num_processors_to_use" title="Link to this definition"></a></dt>
<dd><p>Set the number of processors to use for parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_processors</strong> (<em>int</em>) – Number of processors to use. If -1, uses all available processors
minus one for system processes.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If num_processors is &lt;= 0 (except -1).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Automatically adjusts if requesting too many processors</p></li>
<li><p>Sets the num_workers attribute used by parallel processing methods</p></li>
<li><p>Takes into account system resources to avoid overload</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel.get_num_processors_available" title="bluemath_tk.core.models.BlueMathModel.get_num_processors_available"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_processors_available</span></code></a></dt><dd><p>Get number of available processors</p>
</dd>
<dt><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel.parallel_execute" title="bluemath_tk.core.models.BlueMathModel.parallel_execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parallel_execute</span></code></a></dt><dd><p>Execute functions in parallel</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.set_omp_num_threads">
<span class="sig-name descname"><span class="pre">set_omp_num_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_omp_num_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.set_omp_num_threads" title="Link to this definition"></a></dt>
<dd><p>Set the number of OpenMP threads for parallel operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_threads</strong> (<em>int</em>) – Number of OpenMP threads to use.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Sets the OMP_NUM_THREADS environment variable</p></li>
<li><p>Reloads numpy to ensure new thread settings take effect</p></li>
<li><p>May affect other libraries using OpenMP</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This method is under development and behavior may change</p></li>
<li><p>Reloading numpy may have side effects in running calculations</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel.set_num_processors_to_use" title="bluemath_tk.core.models.BlueMathModel.set_num_processors_to_use"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_num_processors_to_use</span></code></a></dt><dd><p>Set number of processors for BlueMath parallel processing</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.models.BlueMathModel.standarize">
<span class="sig-name descname"><span class="pre">standarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StandardScaler</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.standarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.models.BlueMathModel.standarize" title="Link to this definition"></a></dt>
<dd><p>Standarize data using StandardScaler.
More info in bluemath_tk.core.operations.standarize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Input data to be standarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em><em>, </em><em>optional</em>) – Scaler object to use for standarization. Default is None.</p></li>
<li><p><strong>transform</strong> (<em>bool</em>) – Whether to just transform the data. Default to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray, pd.DataFrame or xr.Dataset</em>) – Standarized data.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bluemath_tk.core.operations">
<span id="bluemath-tk-core-operations-module"></span><h2>bluemath_tk.core.operations module<a class="headerlink" href="#module-bluemath_tk.core.operations" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.convert_lonlat_to_utm">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">convert_lonlat_to_utm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">CRS</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#convert_lonlat_to_utm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.convert_lonlat_to_utm" title="Link to this definition"></a></dt>
<dd><p>This method converts Longitude and Latitude to UTM coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – The longitude values.</p></li>
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – The latitude values.</p></li>
<li><p><strong>projection</strong> (<em>int</em><em>, </em><em>str</em><em>, </em><em>dict</em><em>, </em><em>pyproj.CRS</em>) – The projection to use for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The x and y coordinates in UTM.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.convert_utm_to_lonlat">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">convert_utm_to_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utm_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utm_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">CRS</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#convert_utm_to_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.convert_utm_to_lonlat" title="Link to this definition"></a></dt>
<dd><p>This method converts UTM coordinates to Longitude and Latitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utm_x</strong> (<em>np.ndarray</em>) – The x values in UTM.</p></li>
<li><p><strong>utm_y</strong> (<em>np.ndarray</em>) – The y values in UTM.</p></li>
<li><p><strong>projection</strong> (<em>int</em><em>, </em><em>str</em><em>, </em><em>dict</em><em>, </em><em>pyproj.CRS</em>) – The projection to use for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The longitude and latitude values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.denormalize">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">denormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#denormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.denormalize" title="Link to this definition"></a></dt>
<dd><p>Denormalize data using provided scale_factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Input data that has been normalized and needs to be denormalized.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – Dictionary with variables as keys and a list with two values as
values. The first value is the minimum and the second value is the
maximum used to denormalize the variable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Denormalized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame or xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method does not modify the input data, it creates a copy of the
dataframe / dataset and denormalizes it.</p></li>
<li><p>The denormalization is done variable by variable, i.e. the minimum and
maximum values are used to scale the data back to its original range.</p></li>
<li><p>Assumes that the scale_factor dictionary contains appropriate min and
max values for each variable in the normalized_data.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.operation</span><span class="w"> </span><span class="kn">import</span> <span class="n">denormalize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">],</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">denormalized_data</span> <span class="o">=</span> <span class="n">denormalize</span><span class="p">(</span><span class="n">normalized_data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale_factor</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">denormalize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)),</span>
<span class="gp">... </span>        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)),</span>
<span class="gp">... </span>        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">)},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_factor</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">],</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">denormalized_data</span> <span class="o">=</span> <span class="n">denormalize</span><span class="p">(</span><span class="n">normalized_data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="n">scale_factor</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.destandarize">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">destandarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">standarized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#destandarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.destandarize" title="Link to this definition"></a></dt>
<dd><p>Destandarize data using provided scaler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Standarized data to be destandarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Destandarized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, pd.DataFrame or xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">standarize</span><span class="p">,</span> <span class="n">destandarize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">standarized_data</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">standarize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">destandarize</span><span class="p">(</span><span class="n">standarized_data</span><span class="o">=</span><span class="n">standarized_data</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="n">scaler</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.get_degrees_from_uv">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">get_degrees_from_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#get_degrees_from_uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.get_degrees_from_uv" title="Link to this definition"></a></dt>
<dd><p>This method calculates the degrees from the u and v components.</p>
<dl>
<dt>Here, we assume u and v represent angles between 0 and 360 degrees,</dt><dd><p>where 0° is the North direction,
and increasing clockwise.</p>
<blockquote>
<div><dl>
<dt>(u=0, v=1)</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>(u=-1, v=0) &lt;———&gt; (u=1, v=0)</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div></blockquote>
<p>(u=0, v=-1)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xu</strong> (<em>np.ndarray</em>) – The u component.</p></li>
<li><p><strong>xv</strong> (<em>np.ndarray</em>) – The v component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.get_uv_components">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">get_uv_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#get_uv_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.get_uv_components" title="Link to this definition"></a></dt>
<dd><p>This method calculates the u and v components for the given directional data.</p>
<dl>
<dt>Here, we assume that the directional data is in degrees,</dt><dd><p>beign 0° the North direction,
and increasing clockwise.</p>
<blockquote>
<div><p>0° N
|
|</p>
</div></blockquote>
</dd>
<dt>270° W &lt;———&gt; 90° E</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>90° S</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_deg</strong> (<em>np.ndarray</em>) – The directional data in degrees.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The u and v components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.mathematical_to_nautical">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">mathematical_to_nautical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">math_degrees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#mathematical_to_nautical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.mathematical_to_nautical" title="Link to this definition"></a></dt>
<dd><p>Convert mathematical degrees (0° at East, counterclockwise) to
nautical degrees (0° at North, clockwise)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>math_degrees</strong> (<em>float</em><em> or </em><em>array-like</em>) – Directional angle in mathematical convention</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directional angle in nautical convention</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.nautical_to_mathematical">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">nautical_to_mathematical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nautical_degrees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#nautical_to_mathematical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.nautical_to_mathematical" title="Link to this definition"></a></dt>
<dd><p>Convert nautical degrees (0° at North, clockwise) to
mathematical degrees (0° at East, counterclockwise)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nautical_degrees</strong> (<em>np.ndarray</em>) – Directional angle in nautical convention</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directional angle in mathematical convention</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.normalize">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize data to 0-1 using min max scaler approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Input data to be normalized.</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with variables as keys and a list with two values as
values. The first value is the minimum and the second value is the
maximum used to normalize the variable. If not provided, the
minimum and maximum values of the variable are used.</p></li>
<li><p><strong>logger</strong> (<em>logging.Logger</em><em>, </em><em>optional</em>) – Logger object to log warnings if the custom min or max is bigger or
lower than the datapoints.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame or xr.Dataset</em>) – Normalized data.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – Dictionary with variables as keys and a list with two values as
values. The first value is the minimum and the second value is the
maximum used to normalize the variable.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method does not modify the input data, it creates a copy of the
dataframe / dataset and normalizes it.</p></li>
<li><p>The normalization is done variable by variable, i.e. the minimum and
maximum values are calculated for each variable.</p></li>
<li><p>If custom min or max is bigger or lower than the datapoints, it will
be changed to the minimum or maximum of the datapoints and a warning
will be logged.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalized_data</span><span class="p">,</span> <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;time&quot;</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">)},</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalized_data</span><span class="p">,</span> <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.spatial_gradient">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">spatial_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#spatial_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.spatial_gradient" title="Link to this definition"></a></dt>
<dd><p>Calculate spatial gradient of a DataArray with dimensions (time, latitude, longitude).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>xr.DataArray</em>) – Input data with dimensions (time, latitude, longitude).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradient magnitude with same dimensions as input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The gradient is calculated using central differences, accounting for
latitude-dependent grid spacing in spherical coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.core.operations.standarize">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.operations.</span></span><span class="sig-name descname"><span class="pre">standarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StandardScaler</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/operations.html#standarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.operations.standarize" title="Link to this definition"></a></dt>
<dd><p>Standarize data to have mean 0 and std 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Input data to be standarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em><em>, </em><em>optional</em>) – Scaler object to use for standarization. Default is None.</p></li>
<li><p><strong>transform</strong> (<em>bool</em>) – Whether to just transform the data. Default to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray, pd.DataFrame or xr.Dataset</em>) – Standarized data.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">standarize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">standarized_data</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">standarize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-bluemath_tk.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bluemath_tk.core" title="Link to this heading"></a></h2>
<p>Project: BlueMath_tk
Sub-Module: core
Author: GeoOcean Research Group, Universidad de Cantabria
Repository: <a class="reference external" href="https://github.com/GeoOcean/BlueMath_tk.git">https://github.com/GeoOcean/BlueMath_tk.git</a>
Status: Under development (Working)</p>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.core.</span></span><span class="sig-name descname"><span class="pre">BlueMathModel</span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for handling default functionalities across the project.</p>
<p>This class provides core functionality used by all BlueMath models including:
- Model saving and loading
- Data normalization and denormalization
- Parallel processing capabilities
- Logging functionality
- NaN handling
- Directional data processing</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.gravity">
<span class="sig-name descname"><span class="pre">gravity</span></span><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.gravity" title="Link to this definition"></a></dt>
<dd><p>Gravitational constant from scipy.constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.earth_radius">
<span class="sig-name descname"><span class="pre">earth_radius</span></span><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.earth_radius" title="Link to this definition"></a></dt>
<dd><p>Earth radius in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.num_workers" title="Link to this definition"></a></dt>
<dd><p>Number of parallel workers to use for processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.logger" title="Link to this definition"></a></dt>
<dd><p>Logger instance for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<p>All BlueMath models should inherit from this class to ensure consistent
behavior and functionality across the project.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.check_nans">
<span class="sig-name descname"><span class="pre">check_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.check_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.check_nans" title="Link to this definition"></a></dt>
<dd><p>Check for NaNs in the data and optionally replace them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.Series</em><em>, </em><em>pd.DataFrame</em><em>, </em><em>xr.DataArray</em><em>, </em><em>xr.Dataset</em><em>]</em>) – The data to check for NaNs.</p></li>
<li><p><strong>replace_value</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>callable</em><em>]</em><em>, </em><em>optional</em>) – Value to replace NaNs with. If callable, the function will be called
on the data. Default is None (no replacement).</p></li>
<li><p><strong>raise_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to raise an error if NaNs are found. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – The data with NaNs optionally replaced.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[np.ndarray, pd.Series, pd.DataFrame, xr.DataArray, xr.Dataset]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If NaNs are found and raise_error is True.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For numpy arrays, uses np.isnan() to check for NaNs</p></li>
<li><p>For pandas objects, uses isnull() to check for NaNs</p></li>
<li><p>For xarray objects, uses isnull() to check for NaNs</p></li>
<li><p>If replace_value is callable, it takes precedence over other options</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cleaned_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">check_nans</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">replace_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">)</span>
<span class="go">   a</span>
<span class="go">0  1</span>
<span class="go">1  0</span>
<span class="go">2  3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.denormalize">
<span class="sig-name descname"><span class="pre">denormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.denormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.denormalize" title="Link to this definition"></a></dt>
<dd><p>Denormalize data using provided scale_factor.
More info in bluemath_tk.core.operations.denormalize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame</em>) – The normalized data to denormalize.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – The scale factors used for denormalization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – The denormalized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.destandarize">
<span class="sig-name descname"><span class="pre">destandarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">standarized_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.destandarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.destandarize" title="Link to this definition"></a></dt>
<dd><p>Destandarize data using provided scaler.
More info in bluemath_tk.core.operations.destandarize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Standarized data to be destandarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Destandarized data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, pd.DataFrame or xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">earth_radius</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6378.135</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.get_degrees_from_uv">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_degrees_from_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_degrees_from_uv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.get_degrees_from_uv" title="Link to this definition"></a></dt>
<dd><p>This method calculates the degrees from the u and v components.</p>
<dl>
<dt>Here, we assume u and v represent angles between 0 and 360 degrees,</dt><dd><p>where 0° is the North direction,
and increasing clockwise.</p>
<blockquote>
<div><dl>
<dt>(u=0, v=1)</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>(u=-1, v=0) &lt;———&gt; (u=1, v=0)</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div></blockquote>
<p>(u=0, v=-1)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xu</strong> (<em>np.ndarray</em>) – The u component.</p></li>
<li><p><strong>xv</strong> (<em>np.ndarray</em>) – The v component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.get_metrics">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.get_metrics" title="Link to this definition"></a></dt>
<dd><p>Gets the metrics of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The first dataset.</p></li>
<li><p><strong>data2</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The second dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – The metrics of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the DataFrames or Datasets have different shapes.</p></li>
<li><p><strong>TypeError</strong> – If the inputs are not both DataFrames or both xarray Datasets.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.get_num_processors_available">
<span class="sig-name descname"><span class="pre">get_num_processors_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_num_processors_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.get_num_processors_available" title="Link to this definition"></a></dt>
<dd><p>Gets the number of processors available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of processors available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.get_uv_components">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_uv_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.get_uv_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.get_uv_components" title="Link to this definition"></a></dt>
<dd><p>This method calculates the u and v components for the given directional data.</p>
<dl>
<dt>Here, we assume that the directional data is in degrees,</dt><dd><p>beign 0° the North direction,
and increasing clockwise.</p>
<blockquote>
<div><dl>
<dt>0° N</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>270° W &lt;———&gt; 90° E</dt><dd><blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div></blockquote>
<p>90° S</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_deg</strong> (<em>np.ndarray</em>) – The directional data in degrees.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The u and v components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">gravity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9.80665</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.list_class_attributes">
<span class="sig-name descname"><span class="pre">list_class_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.list_class_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.list_class_attributes" title="Link to this definition"></a></dt>
<dd><p>List all non-callable attributes of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Names of all non-callable, non-private attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Excludes methods and private attributes (starting with __)</p></li>
<li><p>Includes properties and class variables</p></li>
<li><p>Useful for introspection and debugging</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">attrs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">list_class_attributes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
<span class="go">[&#39;gravity&#39;, &#39;num_workers&#39;, &#39;_logger&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.list_class_methods">
<span class="sig-name descname"><span class="pre">list_class_methods</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.list_class_methods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.list_class_methods" title="Link to this definition"></a></dt>
<dd><p>List all callable methods of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Names of all callable, non-private methods.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Excludes attributes and private methods (starting with __)</p></li>
<li><p>Includes instance methods and properties</p></li>
<li><p>Useful for introspection and debugging</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methods</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">list_class_methods</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>
<span class="go">[&#39;normalize&#39;, &#39;denormalize&#39;, &#39;check_nans&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bluemath_tk.core.models.BlueMathModel" title="bluemath_tk.core.models.BlueMathModel"><span class="pre">BlueMathModel</span></a></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.load_model" title="Link to this definition"></a></dt>
<dd><p>Loads the model from a file.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id7">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Get the logger instance for this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The logger instance. Creates a new file logger if none exists.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>logging.Logger</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Lazily instantiates logger on first access</p></li>
<li><p>Uses class name as default logger name</p></li>
<li><p>Thread-safe logger creation</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize data to 0-1 using min max scaler approach.
More info in bluemath_tk.core.operations.normalize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – The data to normalize.</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – Custom scale factors for normalization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>pd.DataFrame or xr.Dataset</em>) – The normalized data.</p></li>
<li><p><strong>scale_factor</strong> (<em>dict</em>) – The scale factors used for normalization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.parallel_execute">
<span class="sig-name descname"><span class="pre">parallel_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu_intensive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.parallel_execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.parallel_execute" title="Link to this definition"></a></dt>
<dd><p>Execute a function in parallel across multiple items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>Callable</em>) – The function to execute. Should accept single item and <a href="#id9"><span class="problematic" id="id10">**</span></a>kwargs.</p></li>
<li><p><strong>items</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – List of items to process in parallel.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of parallel workers to use.</p></li>
<li><p><strong>cpu_intensive</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses ProcessPoolExecutor, otherwise ThreadPoolExecutor.
Default is False.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to func.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping item indices to function results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[int, Any]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – Any exception raised by func is logged and the job continues.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses ThreadPoolExecutor for I/O-bound tasks</p></li>
<li><p>Uses ProcessPoolExecutor for CPU-bound tasks</p></li>
<li><p>Results maintain original item order via index mapping</p></li>
<li><p>Failed jobs are logged but don’t stop execution</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>ThreadPoolExecutor may have GIL limitations</p></li>
<li><p>ProcessPoolExecutor doesn’t work with non-picklable objects</p></li>
<li><p>File operations may fail with ThreadPoolExecutor</p></li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parallel_execute</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">{0: 1, 1: 4, 2: 9}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_attributes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.save_model" title="Link to this definition"></a></dt>
<dd><p>Save the model to a file using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path where the model will be saved.</p></li>
<li><p><strong>exclude_attributes</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of attribute names to exclude from saving. Default is None.
If provided, it will override the default _exclude_attributes.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses pickle for serialization</p></li>
<li><p>Warns if any xarray Datasets/DataArrays are being pickled</p></li>
<li><p>Creates parent directories if they don’t exist</p></li>
<li><p>Excludes specified attributes from serialization</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Pickle files can be security risks if loaded from untrusted sources</p></li>
<li><p>xarray objects in the model will be pickled and may be large</p></li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MyBlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model.pkl&#39;</span><span class="p">,</span> <span class="n">exclude_attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_logger&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.set_logger_name">
<span class="sig-name descname"><span class="pre">set_logger_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'INFO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">console</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_logger_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.set_logger_name" title="Link to this definition"></a></dt>
<dd><p>Configure the model’s logger with a new name and settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name to give to the logger.</p></li>
<li><p><strong>level</strong> (<em>str</em><em>, </em><em>optional</em>) – The logging level to use. Default is “INFO”.
Valid values are: “DEBUG”, “INFO”, “WARNING”, “ERROR”, “CRITICAL”</p></li>
<li><p><strong>console</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to output logs to console. Default is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Creates a new file logger with specified settings</p></li>
<li><p>Previous logger settings are overwritten</p></li>
<li><p>Log files are created in the default logging directory</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BlueMathModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">set_logger_name</span><span class="p">(</span><span class="s2">&quot;my_model&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="n">console</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.set_num_processors_to_use">
<span class="sig-name descname"><span class="pre">set_num_processors_to_use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_processors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_num_processors_to_use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.set_num_processors_to_use" title="Link to this definition"></a></dt>
<dd><p>Set the number of processors to use for parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_processors</strong> (<em>int</em>) – Number of processors to use. If -1, uses all available processors
minus one for system processes.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If num_processors is &lt;= 0 (except -1).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Automatically adjusts if requesting too many processors</p></li>
<li><p>Sets the num_workers attribute used by parallel processing methods</p></li>
<li><p>Takes into account system resources to avoid overload</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bluemath_tk.core.BlueMathModel.get_num_processors_available" title="bluemath_tk.core.BlueMathModel.get_num_processors_available"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_processors_available</span></code></a></dt><dd><p>Get number of available processors</p>
</dd>
<dt><a class="reference internal" href="#bluemath_tk.core.BlueMathModel.parallel_execute" title="bluemath_tk.core.BlueMathModel.parallel_execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parallel_execute</span></code></a></dt><dd><p>Execute functions in parallel</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.set_omp_num_threads">
<span class="sig-name descname"><span class="pre">set_omp_num_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.set_omp_num_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.set_omp_num_threads" title="Link to this definition"></a></dt>
<dd><p>Set the number of OpenMP threads for parallel operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_threads</strong> (<em>int</em>) – Number of OpenMP threads to use.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Sets the OMP_NUM_THREADS environment variable</p></li>
<li><p>Reloads numpy to ensure new thread settings take effect</p></li>
<li><p>May affect other libraries using OpenMP</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This method is under development and behavior may change</p></li>
<li><p>Reloading numpy may have side effects in running calculations</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bluemath_tk.core.BlueMathModel.set_num_processors_to_use" title="bluemath_tk.core.BlueMathModel.set_num_processors_to_use"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_num_processors_to_use</span></code></a></dt><dd><p>Set number of processors for BlueMath parallel processing</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.core.BlueMathModel.standarize">
<span class="sig-name descname"><span class="pre">standarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StandardScaler</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StandardScaler</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/core/models.html#BlueMathModel.standarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.core.BlueMathModel.standarize" title="Link to this definition"></a></dt>
<dd><p>Standarize data using StandardScaler.
More info in bluemath_tk.core.operations.standarize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em> or </em><em>xr.Dataset</em>) – Input data to be standarized.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em><em>, </em><em>optional</em>) – Scaler object to use for standarization. Default is None.</p></li>
<li><p><strong>transform</strong> (<em>bool</em>) – Whether to just transform the data. Default to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>standarized_data</strong> (<em>np.ndarray, pd.DataFrame or xr.Dataset</em>) – Standarized data.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Scaler object used for standarization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bluemath_tk.config.html" class="btn btn-neutral float-left" title="bluemath_tk.config package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bluemath_tk.core.data.html" class="btn btn-neutral float-right" title="bluemath_tk.core.data package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, GeoOcean Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>