

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bluemath_tk.datamining package &mdash; Bluemath-Toolkit  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bluemath_tk.distributions package" href="bluemath_tk.distributions.html" />
    <link rel="prev" title="bluemath_tk.core.plotting package" href="bluemath_tk.core.plotting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Bluemath-Toolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contributions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bluemath_tk</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bluemath_tk.html">bluemath_tk package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bluemath_tk.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.additive.html">bluemath_tk.additive package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.config.html">bluemath_tk.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.core.html">bluemath_tk.core package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">bluemath_tk.datamining package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.distributions.html">bluemath_tk.distributions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.downloaders.html">bluemath_tk.downloaders package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.interpolation.html">bluemath_tk.interpolation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.predictor.html">bluemath_tk.predictor package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.risk.html">bluemath_tk.risk package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.setup.html">bluemath_tk.setup package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.tcs.html">bluemath_tk.tcs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.teslakit.html">bluemath_tk.teslakit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.tide.html">bluemath_tk.tide package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.topo_bathy.html">bluemath_tk.topo_bathy package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.waves.html">bluemath_tk.waves package</a></li>
<li class="toctree-l4"><a class="reference internal" href="bluemath_tk.wrappers.html">bluemath_tk.wrappers package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bluemath_tk.html#module-bluemath_tk">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bluemath-Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">bluemath_tk</a></li>
          <li class="breadcrumb-item"><a href="bluemath_tk.html">bluemath_tk package</a></li>
      <li class="breadcrumb-item active">bluemath_tk.datamining package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bluemath_tk.datamining.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bluemath-tk-datamining-package">
<h1>bluemath_tk.datamining package<a class="headerlink" href="#bluemath-tk-datamining-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-bluemath_tk.datamining.kma">
<span id="bluemath-tk-datamining-kma-module"></span><h2>bluemath_tk.datamining.kma module<a class="headerlink" href="#module-bluemath_tk.datamining.kma" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.kma.</span></span><span class="sig-name descname"><span class="pre">KMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>K-Means Algorithm (KMA) class.</p>
<p>This class performs the K-Means algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.num_clusters">
<span class="sig-name descname"><span class="pre">num_clusters</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.num_clusters" title="Link to this definition"></a></dt>
<dd><p>The number of clusters to use in the K-Means algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.seed" title="Link to this definition"></a></dt>
<dd><p>The random seed to use as initial datapoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.centroid_real_indices">
<span class="sig-name descname"><span class="pre">centroid_real_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.centroid_real_indices" title="Link to this definition"></a></dt>
<dd><p>The real indices of the selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag indicating whether the model is fitted or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.kma</span><span class="w"> </span><span class="kn">import</span> <span class="n">KMA</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">kma</span> <span class="o">=</span> <span class="n">KMA</span><span class="p">(</span><span class="n">num_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">kma</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">kma</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 10 Axes&gt;,
 array([[&lt;Axes: xlabel=&#39;Tp&#39;, ylabel=&#39;Hs&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir&#39;, ylabel=&#39;Tp&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir_u&#39;, ylabel=&#39;Dir&#39;&gt;,
         &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: xlabel=&#39;Dir_v&#39;, ylabel=&#39;Dir_u&#39;&gt;]], dtype=object))
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_0_1.png" src="_images/bluemath_tk.datamining_0_1.png" />
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.add_regression_guided">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_regression_guided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.add_regression_guided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.add_regression_guided" title="Link to this definition"></a></dt>
<dd><p>Calculate regression-guided variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The data to fit the K-Means algorithm.</p></li>
<li><p><strong>vars</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The variables to use for regression-guided clustering.</p></li>
<li><p><strong>alpha</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The alpha values to use for regression-guided clustering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data with the regression-guided variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_number_of_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_guided</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the K-Means algorithm to the provided data.</p>
<p>TODO: Add option to force KMA initialization with MDA centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the KMA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>min_number_of_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The minimum number of points to consider a cluster.
Default is None.</p></li>
<li><p><strong>max_number_of_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the K-Means algorithm.
This is used when min_number_of_points is not None.
Default is 10.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
<li><p><strong>regression_guided</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying regression-guided clustering variables and relative weights.
Example: {“vars”: [“Fe”], “alpha”: [0.6]}.
Default is {}.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_number_of_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_guided</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit the K-Means algorithm to the provided data and predict the nearest centroid
for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the KMA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>min_number_of_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The minimum number of points to consider a cluster.
Default is None.</p></li>
<li><p><strong>max_number_of_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the K-Means algorithm.
This is used when min_number_of_points is not None.
Default is 10.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
<li><p><strong>regression_guided</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying regression-guided clustering variables and relative weights.
Example: {“vars”: [“Fe”], “alpha”: [0.6]}.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point,
and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.kma">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">KMeans</span></em><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.kma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMA.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point,
and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bluemath_tk.datamining.kma.KMAError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.kma.</span></span><span class="sig-name descname"><span class="pre">KMAError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'KMA</span> <span class="pre">error</span> <span class="pre">occurred.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMAError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.kma.KMAError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for KMA class.</p>
</dd></dl>

</section>
<section id="module-bluemath_tk.datamining.lhs">
<span id="bluemath-tk-datamining-lhs-module"></span><h2>bluemath_tk.datamining.lhs module<a class="headerlink" href="#module-bluemath_tk.datamining.lhs" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.lhs.</span></span><span class="sig-name descname"><span class="pre">LHS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampling</span></code></p>
<p>Latin Hypercube Sampling (LHS) class.</p>
<p>This class performs the LHS algorithm for some input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS.num_dimensions">
<span class="sig-name descname"><span class="pre">num_dimensions</span></span><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS.num_dimensions" title="Link to this definition"></a></dt>
<dd><p>The number of dimensions to use in the LHS algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS.seed" title="Link to this definition"></a></dt>
<dd><p>The random seed to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS.lhs">
<span class="sig-name descname"><span class="pre">lhs</span></span><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS.lhs" title="Link to this definition"></a></dt>
<dd><p>The Latin Hypercube object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>qdc.LatinHypercube</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS.data" title="Link to this definition"></a></dt>
<dd><p>The LHS samples dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHS.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensions_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHS.generate" title="Link to this definition"></a></dt>
<dd><p>Generate LHS samples.</p>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This class is designed to perform the LHS algorithm.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.lhs</span><span class="w"> </span><span class="kn">import</span> <span class="n">LHS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimensions_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;SS&#39;</span><span class="p">,</span> <span class="s1">&#39;Qb&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">LHS</span><span class="p">(</span><span class="n">num_dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs_sampled_df</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dimensions_names</span><span class="o">=</span><span class="n">dimensions_names</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lower_bounds</span><span class="o">=</span><span class="n">lower_bounds</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">upper_bounds</span><span class="o">=</span><span class="n">upper_bounds</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensions_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Generate LHS samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimensions_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The names of the dimensions.</p></li>
<li><p><strong>lower_bounds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The lower bounds of the dimensions.</p></li>
<li><p><strong>upper_bounds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The upper bounds of the dimensions.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – The number of samples to generate.
Must be greater than 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.data</strong> – The LHS samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lhs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">LatinHypercube</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bluemath_tk.datamining.lhs.LHSError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.lhs.</span></span><span class="sig-name descname"><span class="pre">LHSError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'LHS</span> <span class="pre">error</span> <span class="pre">occurred.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHSError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.lhs.LHSError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for LHS class.</p>
</dd></dl>

</section>
<section id="module-bluemath_tk.datamining.mda">
<span id="bluemath-tk-datamining-mda-module"></span><h2>bluemath_tk.datamining.mda module<a class="headerlink" href="#module-bluemath_tk.datamining.mda" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.mda.</span></span><span class="sig-name descname"><span class="pre">MDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>Maximum Dissimilarity Algorithm (MDA) class.</p>
<p>This class performs the MDA algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.num_centers">
<span class="sig-name descname"><span class="pre">num_centers</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.num_centers" title="Link to this definition"></a></dt>
<dd><p>The number of centers to use in the MDA algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.centroid_iterative_indices">
<span class="sig-name descname"><span class="pre">centroid_iterative_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.centroid_iterative_indices" title="Link to this definition"></a></dt>
<dd><p>A list of iterative indices of the centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.centroid_real_indices">
<span class="sig-name descname"><span class="pre">centroid_real_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.centroid_real_indices" title="Link to this definition"></a></dt>
<dd><p>The real indices of the selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag indicating whether the model is fitted or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.mda</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDA</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">mda</span> <span class="o">=</span> <span class="n">MDA</span><span class="p">(</span><span class="n">num_centers</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">mda</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 10 Axes&gt;,
 array([[&lt;Axes: xlabel=&#39;Tp&#39;, ylabel=&#39;Hs&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir&#39;, ylabel=&#39;Tp&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir_u&#39;, ylabel=&#39;Dir&#39;&gt;,
         &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: xlabel=&#39;Dir_v&#39;, ylabel=&#39;Dir_u&#39;&gt;]], dtype=object))
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_1_1.png" src="_images/bluemath_tk.datamining_1_1.png" />
</div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_centroid_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the Maximum Dissimilarity Algorithm (MDA) to the provided data.</p>
<p>This method initializes centroids for the MDA algorithm using the provided
dataframe, directional variables, and custom scale factor. It normalizes the
data, iteratively selects centroids based on maximum dissimilarity, and
denormalizes the centroids before returning them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the MDA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>first_centroid_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the first centroid to use in the MDA algorithm.
Default is None.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>When first_centroid_seed is not provided, max value centroid is used.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_centroid_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits the MDA model to the data and predicts the nearest centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the MDA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>first_centroid_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the first centroid to use in the MDA algorithm.
Default is None.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.MDA.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.MDAError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.mda.</span></span><span class="sig-name descname"><span class="pre">MDAError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MDA</span> <span class="pre">error</span> <span class="pre">occurred.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDAError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.MDAError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for MDA class.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.calculate_normalized_squared_distance">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.mda.</span></span><span class="sig-name descname"><span class="pre">calculate_normalized_squared_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_to_compare</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#calculate_normalized_squared_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.calculate_normalized_squared_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate the normalized squared distance between the data_array and the array_to_compare.
ALERT: directional_indices will be deprecated in the future.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_array</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The data array to compare. Dimensions: (1, n_features).</p></li>
<li><p><strong>array_to_compare</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The array to compare against. Dimensions: (n_samples, n_features).</p></li>
<li><p><strong>directional_indices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of column indices that contain directional data.
For these columns, the minimum circular distance will be used.
Default is None.</p></li>
<li><p><strong>weights</strong> (<em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – List of weights to apply to each column’s distance.
Must have the same length as the number of columns.
Default is None (equal weights).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of normalized squared distance between the two arrays.
Dimensions: (n_samples, 1).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the arrays have different numbers of columns.
    If weights are provided but length doesn’t match number of columns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calculate_normalized_squared_distance</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">array_to_compare</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">[0.0, 27.0]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>IMPORTANT: Data is assumed to be normalized before calling this function.</p></li>
<li><p>For directional variables, the function calculates the minimum circular distance.
Assuming data is between 0 and 1 (normalized).</p></li>
<li><p>The function calculates weighted squared differences for each row.</p></li>
<li><p>If DataFrames are provided, they will be converted to numpy arrays.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bluemath_tk.datamining.mda.find_nearest_indices">
<span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.mda.</span></span><span class="sig-name descname"><span class="pre">find_nearest_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#find_nearest_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.mda.find_nearest_indices" title="Link to this definition"></a></dt>
<dd><p>Find the indices of nearest points in reference_points for each point in query_points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The points to find nearest neighbors for.</p></li>
<li><p><strong>reference_points</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em>]</em>) – The set of points to search in.</p></li>
<li><p><strong>directional_indices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of column indices that contain directional data.
For these columns, the minimum circular distance will be used.
Default is None.</p></li>
<li><p><strong>weights</strong> (<em>List</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – List of weights to apply to each column’s distance.
Must have the same length as the number of columns.
Default is None (equal weights).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the index of the nearest reference point for each query point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Finding nearest centroids for data points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 100 points with 3 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 5 centroids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nearest_centroid_indices</span> <span class="o">=</span> <span class="n">find_nearest_indices</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">centroids</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-bluemath_tk.datamining.pca">
<span id="bluemath-tk-datamining-pca-module"></span><h2>bluemath_tk.datamining.pca module<a class="headerlink" href="#module-bluemath_tk.datamining.pca" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.pca.</span></span><span class="sig-name descname"><span class="pre">PCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_incremental</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseReduction</span></code></p>
<p>Principal Component Analysis (PCA) class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.n_components">
<span class="sig-name descname"><span class="pre">n_components</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.n_components" title="Link to this definition"></a></dt>
<dd><p>The number of components or the explained variance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[int, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.is_incremental">
<span class="sig-name descname"><span class="pre">is_incremental</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.is_incremental" title="Link to this definition"></a></dt>
<dd><p>Indicates whether Incremental PCA is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>Indicates whether the PCA model has been fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.scaler">
<span class="sig-name descname"><span class="pre">scaler</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.scaler" title="Link to this definition"></a></dt>
<dd><p>The scaler used for standardizing the data, in case the data is standarized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StandardScaler</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.vars_to_stack">
<span class="sig-name descname"><span class="pre">vars_to_stack</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.vars_to_stack" title="Link to this definition"></a></dt>
<dd><p>The list of variables to stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.window_stacked_vars">
<span class="sig-name descname"><span class="pre">window_stacked_vars</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.window_stacked_vars" title="Link to this definition"></a></dt>
<dd><p>The list of variables with windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.coords_to_stack">
<span class="sig-name descname"><span class="pre">coords_to_stack</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.coords_to_stack" title="Link to this definition"></a></dt>
<dd><p>The list of coordinates to stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.coords_values">
<span class="sig-name descname"><span class="pre">coords_values</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.coords_values" title="Link to this definition"></a></dt>
<dd><p>The values of the data coordinates used in fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.pca_dim_for_rows">
<span class="sig-name descname"><span class="pre">pca_dim_for_rows</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.pca_dim_for_rows" title="Link to this definition"></a></dt>
<dd><p>The dimension for rows in PCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.windows_in_pca_dim_for_rows">
<span class="sig-name descname"><span class="pre">windows_in_pca_dim_for_rows</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.windows_in_pca_dim_for_rows" title="Link to this definition"></a></dt>
<dd><p>The windows in PCA dimension for rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.value_to_replace_nans">
<span class="sig-name descname"><span class="pre">value_to_replace_nans</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.value_to_replace_nans" title="Link to this definition"></a></dt>
<dd><p>The values to replace NaNs in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.nan_threshold_to_drop">
<span class="sig-name descname"><span class="pre">nan_threshold_to_drop</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.nan_threshold_to_drop" title="Link to this definition"></a></dt>
<dd><p>The threshold percentage to drop NaNs for each variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.num_cols_for_vars">
<span class="sig-name descname"><span class="pre">num_cols_for_vars</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.num_cols_for_vars" title="Link to this definition"></a></dt>
<dd><p>The number of columns for variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.pcs">
<span class="sig-name descname"><span class="pre">pcs</span></span><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.pcs" title="Link to this definition"></a></dt>
<dd><p>The Principal Components (PCs).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.data.sample_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_2d_dataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">get_2d_dataset</span><span class="p">()</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">is_incremental</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
    <span class="n">vars_to_stack</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">coords_to_stack</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;coord1&quot;</span><span class="p">,</span> <span class="s2">&quot;coord2&quot;</span><span class="p">],</span>
    <span class="n">pca_dim_for_rows</span><span class="o">=</span><span class="s2">&quot;coord3&quot;</span><span class="p">,</span>
    <span class="n">windows_in_pca_dim_for_rows</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">value_to_replace_nans</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
    <span class="n">nan_threshold_to_drop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">pcs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">reconstructed_ds</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">PCs</span><span class="o">=</span><span class="n">pcs</span><span class="p">)</span>
<span class="n">eofs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">eofs</span>
<span class="n">explained_variance</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance</span>
<span class="n">explained_variance_ratio</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio</span>
<span class="n">cumulative_explained_variance_ratio</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">cumulative_explained_variance_ratio</span>

<span class="c1"># Save the full class in a pickle file</span>
<span class="n">pca</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s2">&quot;pca_model.pkl&quot;</span><span class="p">)</span>

<span class="c1"># Plot the calculated EOFs</span>
<span class="n">pca</span><span class="o">.</span><span class="n">plot_eofs</span><span class="p">(</span><span class="n">vars_to_plot</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">],</span> <span class="n">num_eofs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
        -------------------------------------------------------------------
        | Initializing PCA reduction model with the following parameters:
        |    - n_components: 5
        |    - is_incremental: False
        | For more information, please refer to the documentation.
        -------------------------------------------------------------------
        
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_2_15.png" src="_images/bluemath_tk.datamining_2_15.png" />
<img alt="_images/bluemath_tk.datamining_2_16.png" src="_images/bluemath_tk.datamining_2_16.png" />
</div>
</div>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html</a></p>
<p>[2] <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.IncrementalPCA.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.IncrementalPCA.html</a></p>
<p>[3] <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0378383911000676">https://www.sciencedirect.com/science/article/abs/pii/S0378383911000676</a></p>
<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.cumulative_explained_variance_ratio">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cumulative_explained_variance_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.cumulative_explained_variance_ratio" title="Link to this definition"></a></dt>
<dd><p>Return the cumulative explained variance ratio of the PCA model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the raw data used for PCA.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.eofs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eofs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.eofs" title="Link to this definition"></a></dt>
<dd><p>Return the Empirical Orthogonal Functions (EOFs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.explained_variance">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explained_variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.explained_variance" title="Link to this definition"></a></dt>
<dd><p>Return the explained variance of the PCA model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.explained_variance_ratio">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explained_variance_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.explained_variance_ratio" title="Link to this definition"></a></dt>
<dd><p>Return the explained variance ratio of the PCA model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_in_pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_replace_nans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_threshold_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit PCA model to data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to fit the PCA model.</p></li>
<li><p><strong>vars_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The variables to stack.</p></li>
<li><p><strong>coords_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The coordinates to stack.</p></li>
<li><p><strong>pca_dim_for_rows</strong> (<em>str</em>) – The PCA dimension to maintain in rows (usually the time).</p></li>
<li><p><strong>windows_in_pca_dim_for_rows</strong> (<em>dict</em><em>, </em><em>optional</em>) – The window steps to roll the pca_dim_for_rows for each variable. Default is {}.</p></li>
<li><p><strong>value_to_replace_nans</strong> (<em>dict</em><em>, </em><em>optional</em>) – The value to replace NaNs for each variable. Default is {}.</p></li>
<li><p><strong>nan_threshold_to_drop</strong> (<em>dict</em><em>, </em><em>optional</em>) – The threshold percentage to drop NaNs for each variable.
By default, variables with less than 90% of valid values are dropped, which
corresponds to {‘ALL_vars’: 0.9}.
To for example use all available data for variable ‘wind’, you must provide
nan_threshold_to_drop: {‘wind’: 1e-9}.
Default is {}.</p></li>
<li><p><strong>scale_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scale the data. Default is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For both value_to_replace_nans and nan_threshold_to_drop, the keys are the variables,
and the suffixes for the windows are considered.
Example: if you have variable “X”, and apply windows [1, 2, 3], you can use “X_1”, “X_2”, “X_3”.
Nevertheless, you can also use the original variable name “X” to apply the same value for all windows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_in_pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_replace_nans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_threshold_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.fit_transform" title="Link to this definition"></a></dt>
<dd><p>Fit and transform data using PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to fit the PCA model.</p></li>
<li><p><strong>vars_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The variables to stack.</p></li>
<li><p><strong>coords_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The coordinates to stack.</p></li>
<li><p><strong>pca_dim_for_rows</strong> (<em>str</em>) – The PCA dimension to maintain in rows (usually the time).</p></li>
<li><p><strong>windows_in_pca_dim_for_rows</strong> (<em>dict</em><em>, </em><em>optional</em>) – The window steps to roll the pca_dim_for_rows for each variable. Default is {}.</p></li>
<li><p><strong>value_to_replace_nans</strong> (<em>dict</em><em>, </em><em>optional</em>) – The value to replace NaNs for each variable. Default is {}.</p></li>
<li><p><strong>nan_threshold_to_drop</strong> (<em>dict</em><em>, </em><em>optional</em>) – The threshold percentage to drop NaNs for each variable.
By default, variables with less than 90% of valid values are dropped, which
corresponds to {‘ALL_vars’: 0.9}.
To for example use all available data for variable ‘wind’, you must provide
nan_threshold_to_drop: {‘wind’: 1e-9}.
Default is {}.</p></li>
<li><p><strong>scale_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scale the data. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed data representing the Principal Components (PCs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For both value_to_replace_nans and nan_threshold_to_drop, the keys are the variables,
and the suffixes for the windows are considered.
Example: if you have variable “X”, and apply windows [1, 2, 3], you can use “X_1”, “X_2”, “X_3”.
Nevertheless, you can also use the original variable name “X” to apply the same value for all windows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PCs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.inverse_transform" title="Link to this definition"></a></dt>
<dd><p>Inverse transform data using the fitted PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PCs</strong> (<em>Union</em><em>[</em><em>xr.DataArray</em><em>, </em><em>xr.Dataset</em><em>]</em>) – The data to inverse transform. It should be the Principal Components (PCs).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The inverse transformed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.pca">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pca</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PCA</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IncrementalPCA</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.pca" title="Link to this definition"></a></dt>
<dd><p>Returns the PCA or IncrementalPCA instance used for dimensionality reduction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.pcs_df">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcs_df</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.pcs_df" title="Link to this definition"></a></dt>
<dd><p>Returns the principal components as a DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.plot_eofs">
<span class="sig-name descname"><span class="pre">plot_eofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars_to_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eofs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destandarize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.plot_eofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.plot_eofs" title="Link to this definition"></a></dt>
<dd><p>Plot the Empirical Orthogonal Functions (EOFs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vars_to_plot</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The variables to plot.</p></li>
<li><p><strong>num_eofs</strong> (<em>int</em>) – The number of EOFs to plot.</p></li>
<li><p><strong>destandarize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, destandarize the EOFs. Default is False.</p></li>
<li><p><strong>map_center</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The center of the map. Default is None.
First value is the longitude (-180, 180), and the second value is the latitude (-90, 90).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.plot_pcs">
<span class="sig-name descname"><span class="pre">plot_pcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_pcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.plot_pcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.plot_pcs" title="Link to this definition"></a></dt>
<dd><p>Plot the Principal Components (PCs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_pcs</strong> (<em>int</em>) – The number of Principal Components (PCs) to plot.</p></li>
<li><p><strong>pcs</strong> (<em>xr.Dataset</em><em>, </em><em>optional</em>) – The Principal Components (PCs) to plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.stacked_data_matrix">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stacked_data_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.stacked_data_matrix" title="Link to this definition"></a></dt>
<dd><p>Return the stacked data matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.standarized_stacked_data_matrix">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">standarized_stacked_data_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.standarized_stacked_data_matrix" title="Link to this definition"></a></dt>
<dd><p>Return the standarized stacked data matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_fitting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.transform" title="Link to this definition"></a></dt>
<dd><p>Transform data using the fitted PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to transform.</p></li>
<li><p><strong>after_fitting</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use the already processed data. Default is False.
This is just used in the fit_transform method!</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCA.window_processed_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_processed_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.pca.PCA.window_processed_data" title="Link to this definition"></a></dt>
<dd><p>Return the window processed data used for PCA.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bluemath_tk.datamining.pca.PCAError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.pca.</span></span><span class="sig-name descname"><span class="pre">PCAError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PCA</span> <span class="pre">error</span> <span class="pre">occurred.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCAError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.pca.PCAError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for PCA class.</p>
</dd></dl>

</section>
<section id="module-bluemath_tk.datamining.som">
<span id="bluemath-tk-datamining-som-module"></span><h2>bluemath_tk.datamining.som module<a class="headerlink" href="#module-bluemath_tk.datamining.som" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.som.</span></span><span class="sig-name descname"><span class="pre">SOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">som_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_decay_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>Self-Organizing Maps (SOM) class.</p>
<p>This class performs the Self-Organizing Map algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.som_shape">
<span class="sig-name descname"><span class="pre">som_shape</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.som_shape" title="Link to this definition"></a></dt>
<dd><p>The shape of the SOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.num_dimensions">
<span class="sig-name descname"><span class="pre">num_dimensions</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.num_dimensions" title="Link to this definition"></a></dt>
<dd><p>The number of dimensions of the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag to check if the SOM model is fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>Check MiniSom documentation for more information:</dt><dd><p><a class="reference external" href="https://github.com/JustGlowing/minisom">https://github.com/JustGlowing/minisom</a></p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<p>:: jupyter-execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.som</span><span class="w"> </span><span class="kn">import</span> <span class="n">SOM</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">som</span> <span class="o">=</span> <span class="n">SOM</span><span class="p">(</span><span class="n">som_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">num_dimensions</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">som</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.activation_response">
<span class="sig-name descname"><span class="pre">activation_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.activation_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.activation_response" title="Link to this definition"></a></dt>
<dd><p>Returns the activation response of the given data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.distance_map">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.distance_map" title="Link to this definition"></a></dt>
<dd><p>Returns the distance map of the SOM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the SOM model to the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the SOM algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>num_iteration</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations for the SOM fitting.
Default is 1000.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit the SOM algorithm to the provided data and predict the nearest centroid for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the SOM algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>num_iteration</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations for the SOM fitting.
Default is 1000.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the winner neurons for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.get_centroids_probs_for_labels">
<span class="sig-name descname"><span class="pre">get_centroids_probs_for_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.get_centroids_probs_for_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.get_centroids_probs_for_labels" title="Link to this definition"></a></dt>
<dd><p>Returns the labels map of the given data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.plot_centroids_probs_for_labels">
<span class="sig-name descname"><span class="pre">plot_centroids_probs_for_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.plot_centroids_probs_for_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.plot_centroids_probs_for_labels" title="Link to this definition"></a></dt>
<dd><p>Plots the labels map of the given data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.predict" title="Link to this definition"></a></dt>
<dd><p>Predicts the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with the winner neurons and the centroids of the given data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOM.som">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">som</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MiniSom</span></em><a class="headerlink" href="#bluemath_tk.datamining.som.SOM.som" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bluemath_tk.datamining.som.SOMError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.som.</span></span><span class="sig-name descname"><span class="pre">SOMError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SOM</span> <span class="pre">error</span> <span class="pre">occurred.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOMError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.som.SOMError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception for SOM class.</p>
</dd></dl>

</section>
<section id="module-bluemath_tk.datamining">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bluemath_tk.datamining" title="Link to this heading"></a></h2>
<p>Project: BlueMath_tk
Sub-Module: datamining
Author: GeoOcean Research Group, Universidad de Cantabria
Repository: <a class="reference external" href="https://github.com/GeoOcean/BlueMath_tk.git">https://github.com/GeoOcean/BlueMath_tk.git</a>
Status: Under development (Working)</p>
<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.</span></span><span class="sig-name descname"><span class="pre">KMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.KMA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>K-Means Algorithm (KMA) class.</p>
<p>This class performs the K-Means algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.num_clusters">
<span class="sig-name descname"><span class="pre">num_clusters</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.num_clusters" title="Link to this definition"></a></dt>
<dd><p>The number of clusters to use in the K-Means algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.seed" title="Link to this definition"></a></dt>
<dd><p>The random seed to use as initial datapoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.centroid_real_indices">
<span class="sig-name descname"><span class="pre">centroid_real_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.centroid_real_indices" title="Link to this definition"></a></dt>
<dd><p>The real indices of the selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.KMA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag indicating whether the model is fitted or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.kma</span><span class="w"> </span><span class="kn">import</span> <span class="n">KMA</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">kma</span> <span class="o">=</span> <span class="n">KMA</span><span class="p">(</span><span class="n">num_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">kma</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">kma</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 10 Axes&gt;,
 array([[&lt;Axes: xlabel=&#39;Tp&#39;, ylabel=&#39;Hs&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir&#39;, ylabel=&#39;Tp&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir_u&#39;, ylabel=&#39;Dir&#39;&gt;,
         &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: xlabel=&#39;Dir_v&#39;, ylabel=&#39;Dir_u&#39;&gt;]], dtype=object))
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_3_1.png" src="_images/bluemath_tk.datamining_3_1.png" />
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.add_regression_guided">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_regression_guided</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.add_regression_guided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.KMA.add_regression_guided" title="Link to this definition"></a></dt>
<dd><p>Calculate regression-guided variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The data to fit the K-Means algorithm.</p></li>
<li><p><strong>vars</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The variables to use for regression-guided clustering.</p></li>
<li><p><strong>alpha</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The alpha values to use for regression-guided clustering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data with the regression-guided variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.KMA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.KMA.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_number_of_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_guided</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.KMA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the K-Means algorithm to the provided data.</p>
<p>TODO: Add option to force KMA initialization with MDA centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the KMA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>min_number_of_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The minimum number of points to consider a cluster.
Default is None.</p></li>
<li><p><strong>max_number_of_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the K-Means algorithm.
This is used when min_number_of_points is not None.
Default is 10.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
<li><p><strong>regression_guided</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying regression-guided clustering variables and relative weights.
Example: {“vars”: [“Fe”], “alpha”: [0.6]}.
Default is {}.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_number_of_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression_guided</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.KMA.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit the K-Means algorithm to the provided data and predict the nearest centroid
for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the KMA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>min_number_of_points</strong> (<em>int</em><em>, </em><em>optional</em>) – The minimum number of points to consider a cluster.
Default is None.</p></li>
<li><p><strong>max_number_of_iterations</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the K-Means algorithm.
This is used when min_number_of_points is not None.
Default is 10.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
<li><p><strong>regression_guided</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying regression-guided clustering variables and relative weights.
Example: {“vars”: [“Fe”], “alpha”: [0.6]}.
Default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point,
and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.kma">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">KMeans</span></em><a class="headerlink" href="#bluemath_tk.datamining.KMA.kma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.KMA.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.KMA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/kma.html#KMA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.KMA.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point,
and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.</span></span><span class="sig-name descname"><span class="pre">LHS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.LHS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampling</span></code></p>
<p>Latin Hypercube Sampling (LHS) class.</p>
<p>This class performs the LHS algorithm for some input data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS.num_dimensions">
<span class="sig-name descname"><span class="pre">num_dimensions</span></span><a class="headerlink" href="#bluemath_tk.datamining.LHS.num_dimensions" title="Link to this definition"></a></dt>
<dd><p>The number of dimensions to use in the LHS algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#bluemath_tk.datamining.LHS.seed" title="Link to this definition"></a></dt>
<dd><p>The random seed to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS.lhs">
<span class="sig-name descname"><span class="pre">lhs</span></span><a class="headerlink" href="#bluemath_tk.datamining.LHS.lhs" title="Link to this definition"></a></dt>
<dd><p>The Latin Hypercube object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>qdc.LatinHypercube</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#bluemath_tk.datamining.LHS.data" title="Link to this definition"></a></dt>
<dd><p>The LHS samples dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.LHS.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensions_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.LHS.generate" title="Link to this definition"></a></dt>
<dd><p>Generate LHS samples.</p>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This class is designed to perform the LHS algorithm.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.lhs</span><span class="w"> </span><span class="kn">import</span> <span class="n">LHS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dimensions_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;SS&#39;</span><span class="p">,</span> <span class="s1">&#39;Qb&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upper_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">LHS</span><span class="p">(</span><span class="n">num_dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lhs_sampled_df</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dimensions_names</span><span class="o">=</span><span class="n">dimensions_names</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lower_bounds</span><span class="o">=</span><span class="n">lower_bounds</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">upper_bounds</span><span class="o">=</span><span class="n">upper_bounds</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensions_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/lhs.html#LHS.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Generate LHS samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimensions_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The names of the dimensions.</p></li>
<li><p><strong>lower_bounds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The lower bounds of the dimensions.</p></li>
<li><p><strong>upper_bounds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – The upper bounds of the dimensions.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – The number of samples to generate.
Must be greater than 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.data</strong> – The LHS samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lhs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">LatinHypercube</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.</span></span><span class="sig-name descname"><span class="pre">MDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.MDA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>Maximum Dissimilarity Algorithm (MDA) class.</p>
<p>This class performs the MDA algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.num_centers">
<span class="sig-name descname"><span class="pre">num_centers</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.num_centers" title="Link to this definition"></a></dt>
<dd><p>The number of centers to use in the MDA algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.centroid_iterative_indices">
<span class="sig-name descname"><span class="pre">centroid_iterative_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.centroid_iterative_indices" title="Link to this definition"></a></dt>
<dd><p>A list of iterative indices of the centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.centroid_real_indices">
<span class="sig-name descname"><span class="pre">centroid_real_indices</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.centroid_real_indices" title="Link to this definition"></a></dt>
<dd><p>The real indices of the selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.MDA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag indicating whether the model is fitted or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.mda</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDA</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">mda</span> <span class="o">=</span> <span class="n">MDA</span><span class="p">(</span><span class="n">num_centers</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">mda</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 10 Axes&gt;,
 array([[&lt;Axes: xlabel=&#39;Tp&#39;, ylabel=&#39;Hs&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir&#39;, ylabel=&#39;Tp&#39;&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: xlabel=&#39;Dir_u&#39;, ylabel=&#39;Dir&#39;&gt;,
         &lt;Axes: &gt;],
        [&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,
         &lt;Axes: xlabel=&#39;Dir_v&#39;, ylabel=&#39;Dir_u&#39;&gt;]], dtype=object))
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_4_1.png" src="_images/bluemath_tk.datamining_4_1.png" />
</div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.MDA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.MDA.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_centroid_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.MDA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the Maximum Dissimilarity Algorithm (MDA) to the provided data.</p>
<p>This method initializes centroids for the MDA algorithm using the provided
dataframe, directional variables, and custom scale factor. It normalizes the
data, iteratively selects centroids based on maximum dissimilarity, and
denormalizes the centroids before returning them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the MDA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>first_centroid_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the first centroid to use in the MDA algorithm.
Default is None.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>When first_centroid_seed is not provided, max value centroid is used.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_centroid_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.MDA.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits the MDA model to the data and predicts the nearest centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the MDA algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>first_centroid_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the first centroid to use in the MDA algorithm.
Default is None.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.MDA.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.MDA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/mda.html#MDA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.MDA.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the nearest centroid index for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.</span></span><span class="sig-name descname"><span class="pre">PCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_incremental</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseReduction</span></code></p>
<p>Principal Component Analysis (PCA) class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.n_components">
<span class="sig-name descname"><span class="pre">n_components</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.n_components" title="Link to this definition"></a></dt>
<dd><p>The number of components or the explained variance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[int, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.is_incremental">
<span class="sig-name descname"><span class="pre">is_incremental</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.is_incremental" title="Link to this definition"></a></dt>
<dd><p>Indicates whether Incremental PCA is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.is_fitted" title="Link to this definition"></a></dt>
<dd><p>Indicates whether the PCA model has been fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.scaler">
<span class="sig-name descname"><span class="pre">scaler</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.scaler" title="Link to this definition"></a></dt>
<dd><p>The scaler used for standardizing the data, in case the data is standarized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StandardScaler</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.vars_to_stack">
<span class="sig-name descname"><span class="pre">vars_to_stack</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.vars_to_stack" title="Link to this definition"></a></dt>
<dd><p>The list of variables to stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.window_stacked_vars">
<span class="sig-name descname"><span class="pre">window_stacked_vars</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.window_stacked_vars" title="Link to this definition"></a></dt>
<dd><p>The list of variables with windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.coords_to_stack">
<span class="sig-name descname"><span class="pre">coords_to_stack</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.coords_to_stack" title="Link to this definition"></a></dt>
<dd><p>The list of coordinates to stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.coords_values">
<span class="sig-name descname"><span class="pre">coords_values</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.coords_values" title="Link to this definition"></a></dt>
<dd><p>The values of the data coordinates used in fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.pca_dim_for_rows">
<span class="sig-name descname"><span class="pre">pca_dim_for_rows</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.pca_dim_for_rows" title="Link to this definition"></a></dt>
<dd><p>The dimension for rows in PCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.windows_in_pca_dim_for_rows">
<span class="sig-name descname"><span class="pre">windows_in_pca_dim_for_rows</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.windows_in_pca_dim_for_rows" title="Link to this definition"></a></dt>
<dd><p>The windows in PCA dimension for rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.value_to_replace_nans">
<span class="sig-name descname"><span class="pre">value_to_replace_nans</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.value_to_replace_nans" title="Link to this definition"></a></dt>
<dd><p>The values to replace NaNs in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.nan_threshold_to_drop">
<span class="sig-name descname"><span class="pre">nan_threshold_to_drop</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.nan_threshold_to_drop" title="Link to this definition"></a></dt>
<dd><p>The threshold percentage to drop NaNs for each variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.num_cols_for_vars">
<span class="sig-name descname"><span class="pre">num_cols_for_vars</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.num_cols_for_vars" title="Link to this definition"></a></dt>
<dd><p>The number of columns for variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.pcs">
<span class="sig-name descname"><span class="pre">pcs</span></span><a class="headerlink" href="#bluemath_tk.datamining.PCA.pcs" title="Link to this definition"></a></dt>
<dd><p>The Principal Components (PCs).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.core.data.sample_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_2d_dataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">get_2d_dataset</span><span class="p">()</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">is_incremental</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
    <span class="n">vars_to_stack</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">coords_to_stack</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;coord1&quot;</span><span class="p">,</span> <span class="s2">&quot;coord2&quot;</span><span class="p">],</span>
    <span class="n">pca_dim_for_rows</span><span class="o">=</span><span class="s2">&quot;coord3&quot;</span><span class="p">,</span>
    <span class="n">windows_in_pca_dim_for_rows</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">value_to_replace_nans</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
    <span class="n">nan_threshold_to_drop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">pcs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">reconstructed_ds</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">PCs</span><span class="o">=</span><span class="n">pcs</span><span class="p">)</span>
<span class="n">eofs</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">eofs</span>
<span class="n">explained_variance</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance</span>
<span class="n">explained_variance_ratio</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio</span>
<span class="n">cumulative_explained_variance_ratio</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">cumulative_explained_variance_ratio</span>

<span class="c1"># Save the full class in a pickle file</span>
<span class="n">pca</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s2">&quot;pca_model.pkl&quot;</span><span class="p">)</span>

<span class="c1"># Plot the calculated EOFs</span>
<span class="n">pca</span><span class="o">.</span><span class="n">plot_eofs</span><span class="p">(</span><span class="n">vars_to_plot</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">],</span> <span class="n">num_eofs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
        -------------------------------------------------------------------
        | Initializing PCA reduction model with the following parameters:
        |    - n_components: 5
        |    - is_incremental: False
        | For more information, please refer to the documentation.
        -------------------------------------------------------------------
        
</pre></div>
</div>
<img alt="_images/bluemath_tk.datamining_5_15.png" src="_images/bluemath_tk.datamining_5_15.png" />
<img alt="_images/bluemath_tk.datamining_5_16.png" src="_images/bluemath_tk.datamining_5_16.png" />
</div>
</div>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html</a></p>
<p>[2] <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.IncrementalPCA.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.IncrementalPCA.html</a></p>
<p>[3] <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0378383911000676">https://www.sciencedirect.com/science/article/abs/pii/S0378383911000676</a></p>
<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.cumulative_explained_variance_ratio">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cumulative_explained_variance_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.cumulative_explained_variance_ratio" title="Link to this definition"></a></dt>
<dd><p>Return the cumulative explained variance ratio of the PCA model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.data" title="Link to this definition"></a></dt>
<dd><p>Returns the raw data used for PCA.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.eofs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eofs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.eofs" title="Link to this definition"></a></dt>
<dd><p>Return the Empirical Orthogonal Functions (EOFs).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.explained_variance">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explained_variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.explained_variance" title="Link to this definition"></a></dt>
<dd><p>Return the explained variance of the PCA model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.explained_variance_ratio">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explained_variance_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.explained_variance_ratio" title="Link to this definition"></a></dt>
<dd><p>Return the explained variance ratio of the PCA model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_in_pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_replace_nans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_threshold_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.fit" title="Link to this definition"></a></dt>
<dd><p>Fit PCA model to data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to fit the PCA model.</p></li>
<li><p><strong>vars_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The variables to stack.</p></li>
<li><p><strong>coords_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The coordinates to stack.</p></li>
<li><p><strong>pca_dim_for_rows</strong> (<em>str</em>) – The PCA dimension to maintain in rows (usually the time).</p></li>
<li><p><strong>windows_in_pca_dim_for_rows</strong> (<em>dict</em><em>, </em><em>optional</em>) – The window steps to roll the pca_dim_for_rows for each variable. Default is {}.</p></li>
<li><p><strong>value_to_replace_nans</strong> (<em>dict</em><em>, </em><em>optional</em>) – The value to replace NaNs for each variable. Default is {}.</p></li>
<li><p><strong>nan_threshold_to_drop</strong> (<em>dict</em><em>, </em><em>optional</em>) – The threshold percentage to drop NaNs for each variable.
By default, variables with less than 90% of valid values are dropped, which
corresponds to {‘ALL_vars’: 0.9}.
To for example use all available data for variable ‘wind’, you must provide
nan_threshold_to_drop: {‘wind’: 1e-9}.
Default is {}.</p></li>
<li><p><strong>scale_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scale the data. Default is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For both value_to_replace_nans and nan_threshold_to_drop, the keys are the variables,
and the suffixes for the windows are considered.
Example: if you have variable “X”, and apply windows [1, 2, 3], you can use “X_1”, “X_2”, “X_3”.
Nevertheless, you can also use the original variable name “X” to apply the same value for all windows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vars_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_to_stack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_in_pca_dim_for_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_replace_nans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_threshold_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.fit_transform" title="Link to this definition"></a></dt>
<dd><p>Fit and transform data using PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to fit the PCA model.</p></li>
<li><p><strong>vars_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The variables to stack.</p></li>
<li><p><strong>coords_to_stack</strong> (<em>list</em><em> of </em><em>str</em>) – The coordinates to stack.</p></li>
<li><p><strong>pca_dim_for_rows</strong> (<em>str</em>) – The PCA dimension to maintain in rows (usually the time).</p></li>
<li><p><strong>windows_in_pca_dim_for_rows</strong> (<em>dict</em><em>, </em><em>optional</em>) – The window steps to roll the pca_dim_for_rows for each variable. Default is {}.</p></li>
<li><p><strong>value_to_replace_nans</strong> (<em>dict</em><em>, </em><em>optional</em>) – The value to replace NaNs for each variable. Default is {}.</p></li>
<li><p><strong>nan_threshold_to_drop</strong> (<em>dict</em><em>, </em><em>optional</em>) – The threshold percentage to drop NaNs for each variable.
By default, variables with less than 90% of valid values are dropped, which
corresponds to {‘ALL_vars’: 0.9}.
To for example use all available data for variable ‘wind’, you must provide
nan_threshold_to_drop: {‘wind’: 1e-9}.
Default is {}.</p></li>
<li><p><strong>scale_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scale the data. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed data representing the Principal Components (PCs).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For both value_to_replace_nans and nan_threshold_to_drop, the keys are the variables,
and the suffixes for the windows are considered.
Example: if you have variable “X”, and apply windows [1, 2, 3], you can use “X_1”, “X_2”, “X_3”.
Nevertheless, you can also use the original variable name “X” to apply the same value for all windows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PCs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.inverse_transform" title="Link to this definition"></a></dt>
<dd><p>Inverse transform data using the fitted PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>PCs</strong> (<em>Union</em><em>[</em><em>xr.DataArray</em><em>, </em><em>xr.Dataset</em><em>]</em>) – The data to inverse transform. It should be the Principal Components (PCs).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The inverse transformed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.pca">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pca</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PCA</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">IncrementalPCA</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.pca" title="Link to this definition"></a></dt>
<dd><p>Returns the PCA or IncrementalPCA instance used for dimensionality reduction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.pcs_df">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcs_df</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.pcs_df" title="Link to this definition"></a></dt>
<dd><p>Returns the principal components as a DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.plot_eofs">
<span class="sig-name descname"><span class="pre">plot_eofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars_to_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eofs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destandarize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.plot_eofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.plot_eofs" title="Link to this definition"></a></dt>
<dd><p>Plot the Empirical Orthogonal Functions (EOFs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vars_to_plot</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The variables to plot.</p></li>
<li><p><strong>num_eofs</strong> (<em>int</em>) – The number of EOFs to plot.</p></li>
<li><p><strong>destandarize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, destandarize the EOFs. Default is False.</p></li>
<li><p><strong>map_center</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The center of the map. Default is None.
First value is the longitude (-180, 180), and the second value is the latitude (-90, 90).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.plot_pcs">
<span class="sig-name descname"><span class="pre">plot_pcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_pcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.plot_pcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.plot_pcs" title="Link to this definition"></a></dt>
<dd><p>Plot the Principal Components (PCs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_pcs</strong> (<em>int</em>) – The number of Principal Components (PCs) to plot.</p></li>
<li><p><strong>pcs</strong> (<em>xr.Dataset</em><em>, </em><em>optional</em>) – The Principal Components (PCs) to plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.stacked_data_matrix">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stacked_data_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.stacked_data_matrix" title="Link to this definition"></a></dt>
<dd><p>Return the stacked data matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.standarized_stacked_data_matrix">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">standarized_stacked_data_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.standarized_stacked_data_matrix" title="Link to this definition"></a></dt>
<dd><p>Return the standarized stacked data matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_fitting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/pca.html#PCA.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.PCA.transform" title="Link to this definition"></a></dt>
<dd><p>Transform data using the fitted PCA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – The data to transform.</p></li>
<li><p><strong>after_fitting</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use the already processed data. Default is False.
This is just used in the fit_transform method!</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.PCA.window_processed_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_processed_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span></em><a class="headerlink" href="#bluemath_tk.datamining.PCA.window_processed_data" title="Link to this definition"></a></dt>
<dd><p>Return the window processed data used for PCA.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bluemath_tk.datamining.</span></span><span class="sig-name descname"><span class="pre">SOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">som_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_decay_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseClustering</span></code></p>
<p>Self-Organizing Maps (SOM) class.</p>
<p>This class performs the Self-Organizing Map algorithm on a given dataframe.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.som_shape">
<span class="sig-name descname"><span class="pre">som_shape</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.som_shape" title="Link to this definition"></a></dt>
<dd><p>The shape of the SOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.num_dimensions">
<span class="sig-name descname"><span class="pre">num_dimensions</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.num_dimensions" title="Link to this definition"></a></dt>
<dd><p>The number of dimensions of the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.data_variables">
<span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.data_variables" title="Link to this definition"></a></dt>
<dd><p>A list with all data variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.directional_variables">
<span class="sig-name descname"><span class="pre">directional_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.directional_variables" title="Link to this definition"></a></dt>
<dd><p>A list with directional variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.fitting_variables">
<span class="sig-name descname"><span class="pre">fitting_variables</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.fitting_variables" title="Link to this definition"></a></dt>
<dd><p>A list with fitting variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.custom_scale_factor">
<span class="sig-name descname"><span class="pre">custom_scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.custom_scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of custom scale factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.scale_factor" title="Link to this definition"></a></dt>
<dd><p>A dictionary of scale factors (after normalizing the data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.centroids" title="Link to this definition"></a></dt>
<dd><p>The selected centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.normalized_centroids">
<span class="sig-name descname"><span class="pre">normalized_centroids</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.normalized_centroids" title="Link to this definition"></a></dt>
<dd><p>The selected normalized centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.is_fitted">
<span class="sig-name descname"><span class="pre">is_fitted</span></span><a class="headerlink" href="#bluemath_tk.datamining.SOM.is_fitted" title="Link to this definition"></a></dt>
<dd><p>A flag to check if the SOM model is fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>Check MiniSom documentation for more information:</dt><dd><p><a class="reference external" href="https://github.com/JustGlowing/minisom">https://github.com/JustGlowing/minisom</a></p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<p>:: jupyter-execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bluemath_tk.datamining.som</span><span class="w"> </span><span class="kn">import</span> <span class="n">SOM</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Hs&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;Tp&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;Dir&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">som</span> <span class="o">=</span> <span class="n">SOM</span><span class="p">(</span><span class="n">som_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">num_dimensions</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">nearest_centroids_idxs</span><span class="p">,</span> <span class="n">nearest_centroids_df</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">directional_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dir&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">som</span><span class="o">.</span><span class="n">plot_selected_centroids</span><span class="p">(</span><span class="n">plot_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.activation_response">
<span class="sig-name descname"><span class="pre">activation_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.activation_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.activation_response" title="Link to this definition"></a></dt>
<dd><p>Returns the activation response of the given data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.SOM.data" title="Link to this definition"></a></dt>
<dd><p>Returns the original data used for clustering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.data_to_fit">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_to_fit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.SOM.data_to_fit" title="Link to this definition"></a></dt>
<dd><p>Returns the data used for fitting the K-Means algorithm.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.distance_map">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#bluemath_tk.datamining.SOM.distance_map" title="Link to this definition"></a></dt>
<dd><p>Returns the distance map of the SOM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the SOM model to the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the SOM algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>num_iteration</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations for the SOM fitting.
Default is 1000.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_variables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit the SOM algorithm to the provided data and predict the nearest centroid for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the SOM algorithm.</p></li>
<li><p><strong>directional_variables</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A list of directional variables that will be transformed to u and v components.
Then, to use custom_scale_factor, you must specify the variables names with the u and v suffixes.
Example: directional_variables=[“Dir”], custom_scale_factor={“Dir_u”: [0, 1], “Dir_v”: [0, 1]}.
Default is [].</p></li>
<li><p><strong>custom_scale_factor</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary specifying custom scale factors for normalization.
If normalize_data is True, this will be used to normalize the data.
Example: {“Hs”: [0, 10], “Tp”: [0, 10]}.
Default is {}.</p></li>
<li><p><strong>num_iteration</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations for the SOM fitting.
Default is 1000.</p></li>
<li><p><strong>normalize_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag to normalize the data.
If True, the data will be normalized using the custom_scale_factor.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the winner neurons for each data point and the nearest centroids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.get_centroids_probs_for_labels">
<span class="sig-name descname"><span class="pre">get_centroids_probs_for_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.get_centroids_probs_for_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.get_centroids_probs_for_labels" title="Link to this definition"></a></dt>
<dd><p>Returns the labels map of the given data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.normalized_data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalized_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#bluemath_tk.datamining.SOM.normalized_data" title="Link to this definition"></a></dt>
<dd><p>Returns the normalized data used for clustering.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.plot_centroids_probs_for_labels">
<span class="sig-name descname"><span class="pre">plot_centroids_probs_for_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.plot_centroids_probs_for_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.plot_centroids_probs_for_labels" title="Link to this definition"></a></dt>
<dd><p>Plots the labels map of the given data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bluemath_tk/datamining/som.html#SOM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bluemath_tk.datamining.SOM.predict" title="Link to this definition"></a></dt>
<dd><p>Predicts the nearest centroid for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>pd.DataFrame</em>) – The input data to be used for the prediction.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple with the winner neurons and the centroids of the given data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bluemath_tk.datamining.SOM.som">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">som</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">MiniSom</span></em><a class="headerlink" href="#bluemath_tk.datamining.SOM.som" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bluemath_tk.core.plotting.html" class="btn btn-neutral float-left" title="bluemath_tk.core.plotting package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bluemath_tk.distributions.html" class="btn btn-neutral float-right" title="bluemath_tk.distributions package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, GeoOcean Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>